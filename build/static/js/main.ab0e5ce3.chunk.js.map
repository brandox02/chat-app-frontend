{"version":3,"sources":["images/logout.png","images/foto-perfil.png","components/Background/BackgroundReducer.ts","components/ViewListaChat/Head.tsx","redux/enums/searchUsersEnum.ts","redux/actions/SearchUsersActions/setIndexUserSearchedSelectedAction.ts","customAxios.ts","services/userServices.ts","redux/actions/SearchUsersActions/searchUsersApiAction.ts","redux/actions/SearchUsersActions/setUsersSearchActiveModeAction.ts","components/ViewListaChat/Searcher.tsx","redux/enums/chatEnums.ts","types/Chat.ts","services/chatServices.ts","redux/actions/chatActions/findChatApiAction.ts","components/ViewListaChat/ChatCard.tsx","components/ViewListaChat/body/LoadMySelfChats.tsx","components/ViewListaChat/body/SearchingUsers.tsx","components/ViewListaChat/ViewListaChat.tsx","components/ViewChat/Head.tsx","images/previous.png","socket/index.ts","redux/actions/chatActions/updateChatAction.ts","redux/enums/chatsEnums.ts","redux/actions/chatsActions/updateChatsAction.ts","redux/enums/userEnum.ts","redux/reducers/userReducer.ts","redux/reducers/chatsReducer.ts","redux/reducers/chatReducer.ts","redux/reducers/searchUsersReducer.ts","redux/index.ts","socket/listeners/newMessageListener.ts","redux/actions/chatsActions/deleteChatAction.ts","socket/listeners/deleteChatListener.ts","redux/actions/chatActions/deleteChatAction.ts","socket/listeners/createChatListener.ts","redux/actions/chatsActions/insertChatAction.ts","socket/listeners/deleteMessageListener.ts","socket/listeners/index.ts","socket/emitters/index.ts","redux/actions/chatActions/updateChatApiAction.ts","components/ViewChat/Message.tsx","redux/actions/chatsActions/insertChatApiAction.ts","components/ViewChat/Body.tsx","utils/index.ts","images/send.png","redux/actions/chatActions/deleteChatApiAction.ts","components/ViewChat/ViewChat.tsx","images/delete-chat.png","utils/localStorage.ts","services/authServices.ts","redux/actions/chatsActions/findChatApiAction.ts","redux/actions/userActions/findUserApiAction.ts","components/ViewAuth/login/FacialLogin.tsx","images/back.png","components/ViewAuth/login/Login.tsx","components/ViewAuth/Validation.ts","components/ViewAuth/signin/Signin.tsx","components/Background/Background.tsx","App.tsx","index.tsx"],"names":["VIEWS","VIEW_LISTA_CHAT","value","display","VIEW_CHAT","VIEW_AUTH","VIEW_LOGIN","VIEW_SIGNIN","reducer","state","action","f","f2","f3","f4","f5","contextExample","setView","arg0","activeChatId","setActiveChatId","context","React","createContext","Head","searchUsersEnumThunk","searchUsersEnum","userState","useSelector","user","useContext","className","result","username","src","fotoPerfil","alt","width","logoutImage","height","onClick","localStorage","removeItem","setIndexUserSearchedSelectedAction","index","type","SET_INDEX_USER_SEARCHED_SELECTED","payload","indexUserSearchedSelected","axiosClient","axios","create","baseURL","process","userExistsFetch","a","get","params","data","console","log","response","getUserByToken","token","searchUsersByusernameAction","dispatch","getState","SEARCH_USER_API_STARTED","callbackSuccess","callbackError","then","res","catch","error","getUsersByUsernameApi","dataUsers","SEARCH_USER_API_SUCESSS","usersSearchData","SEARCH_USER_API_ERROR","searchUserApiError","setUsersSearchModeActivesSyncAction","active","SET_USERS_SEARCH_MODE_ACTIVE_SYNC","Searcher","chatUpdateEnum","useState","inputSearch","setInputSearch","useDebounce","debounceInputSearch","showSpinnerLoading","setShowSpinnerLoading","useDispatch","searchUsersState","searchUsers","useEffect","loading","setTimeout","style","zIndex","position","id","autoComplete","tabIndex","onChange","e","currentTarget","placeholder","backgroundColor","chatExampleObject","author","createdAt","Date","members","messages","deleteChatApi","chatId","delete","chatUpdateThunk","chatFindThunk","chatDeleteThunk","UPDATE_CHAT","DELETE_CHAT","findChatAction","FIND_CHAT_API_STARTED","getChatApi","chat","FIND_CHAT_API_SUCESSS","FIND_CHAT_API_ERROR","findChatApiError","ChatCard","name","text","urlImageProfile","LoadMySelfChats","chatsState","chats","map","member","lastMessage","length","_id","imageProfile","SearchingUsers","color","borderRadius","UsersSearchData","setChatFinded","ViewListaChat","overflow","usersSearchModeActive","setShowModal","chatState","userSearchedSelected","getUsername","getActive","Dropdown","Toggle","variant","Menu","Item","socket","io","updateChatAction","findChatsEnumThunk","chatInsertThunk","INSERT_CHAT","UPDATE_CHATS","updateChatsAction","findUserEnumThunk","updateUserEnumThunk","updateUserEnum","initialState","contacts","FIND_USER_API_STARTED","FIND_USER_API_SUCCESS","FIND_USER_API_ERROR","UPDATE_USER_API_STARTED","UPDATE_USER_API_SUCCESS","UPDATE_USER_API_ERROR","FIND_CHATS_API_STARTED","FIND_CHATS_API_SUCESSS","FIND_CHATS_API_ERROR","INSERT_CHAT_API_STARTED","INSERT_CHAT_API_SUCESSS","INSERT_CHAT_API_ERROR","filter","store","UPDATE_CHAT_API_STARTED","UPDATE_CHAT_API_SUCESSS","UPDATE_CHAT_API_ERROR","DELETE_CHAT_API_STARTED","DELETE_CHAT_API_SUCESSS","DELETE_CHAT_API_ERROR","reducers","combineReducers","userReducer","chatsReducer","chatReducer","UsersFindedReducer","createStore","composeWithDevTools","applyMiddleware","thunk","newMessageListener","userId","deleteChatsAction","deleteChatListener","mySelfUserId","mySelfChat","createChatListener","some","insertChatsAction","deleteMessageListener","socketId","emitDeleteChat","toSend","emit","on","updateChatApiSuccess","updateChatApiError","param","NEW_MESSAGE","message","body","put","insertNewMessage","sendNewNotificationMessageToServer","DELETE_MESSAGE","messageId","bodyParam","field","deleteMessageAPI","emiteDeleteMessage","Message","children","date","iAm","chatResult","floatValue","bgColorvalue","boxSizing","bottom","right","transform","insertChatApiAction","memberId1","memberId2","callback","newChat","post","createNewChat","insertChatApiSuccess","emiteCreateChat","insertChatApiError","Body","textInput","setTextInput","matchUserFindedBetweenUserChats","setMatchUserFindedBetweenUserChats","moveScrollToBottom","_matchUserFindedBetweenUserChats","chatIdOfChatOfUserSelected","userFindendSelected","forEach","divMessagesContainer","useRef","current","scrollTop","scrollHeight","handlerSendMessage","userIdSearchClick","member1","member2","ref","transition","nombre","timeMessage","hours","getHours","minutes","getMinutes","ampm","formatAMPM","isOwn","getMessagesBody","onKeyPress","key","deleteChatApiSuccess","deleteChatApiError","ViewChat","showModel","canRenderChat","deleteChat","Modal","show","centered","Header","Footer","Button","setTokenLocalStorage","setItem","tokenLS","getItem","registerNewUserAndGetToken","password","imgBase64","userLogImage","verifyUserCorrect","verifyValidToken","tokenValid","findChatsApiAction","anyMemberId","getChatsApi","findChatsApiError","findUserApiAction","dispath","getUserByIdApi","usuario","findUserError","FacialLogin","switchFacialReconitionAndLoginWithCredentialsViews","runLoadApp","webcamRef","Loading","setLoading","imageSrc","getScreenshot","obj","resource","base64image","alert","margin","left","role","aria-hidden","audio","screenshotFormat","messageError","bootstrapStyleInput","Login","passToFacialRecognitionView","setPassToFacialRecognitionView","userValidationLog","setUserValidationLog","passInput","setPassInput","userInput","setUserInput","userDebounce","userExists","submit","validateUserSign","validateSpaceBlack","trim","has2numbers","cadena","n","countNumbers","letter","Number","SignIn","userValidationSign","setUserValidationSign","passValidationSign","setPassValidationSign","val","validate","validatePassSign","Error","Background","useReducer","view","_setView","x","reload","primerFindChat","setPrimerFindChat","emiteNewConnection","firstChat","Provider","Signin","window","addEventListener","preventDefault","returnValue","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ab0e5ce3.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logout.796c4552.png\";","export default __webpack_public_path__ + \"static/media/foto-perfil.a059d971.png\";","import React from \"react\";\r\n\r\n\r\nexport const VIEWS = {\r\n     VIEW_LISTA_CHAT: {\r\n          value: 'VIEW_LISTA_CHAT',\r\n          display: 'd-hidden-chat'\r\n     },\r\n     VIEW_CHAT: {\r\n          value: 'VIEW_CHAT',\r\n          display: 'd-hidden-chat'\r\n     },\r\n     VIEW_AUTH: {\r\n          value: 'VIEW_AUTH',\r\n          display: 'd-hidden'\r\n     },\r\n     VIEW_LOGIN: {\r\n          value: 'VIEW_LOGIN',\r\n          display: ''\r\n     },\r\n     VIEW_SIGNIN: {\r\n          value: 'VIEW_SIGNIN',\r\n          display: 'd-hidden'\r\n     }\r\n\r\n}\r\nexport type paramView = typeof VIEWS.VIEW_CHAT.value | typeof VIEWS.VIEW_LISTA_CHAT.value;\r\n\r\nexport function reducer(state: typeof VIEWS, action: paramView) {\r\n     // ocultamos las otras vistas\r\n     switch (action) {\r\n          case VIEWS.VIEW_CHAT.value:\r\n               const f = VIEWS\r\n               f.VIEW_CHAT.display = '';\r\n               f.VIEW_LISTA_CHAT.display = 'd-hidden-chat';\r\n               f.VIEW_AUTH.display = 'd-hidden';\r\n               f.VIEW_LOGIN.display = 'd-hidden';\r\n               f.VIEW_SIGNIN.display = 'd-hidden';\r\n               return f\r\n          case VIEWS.VIEW_LISTA_CHAT.value:\r\n               const f2 = VIEWS\r\n               f2.VIEW_CHAT.display = 'd-hidden-chat';\r\n               f2.VIEW_AUTH.display = 'd-hidden';\r\n               f2.VIEW_LISTA_CHAT.display = '';\r\n               f2.VIEW_LOGIN.display = 'd-hidden';\r\n               f2.VIEW_SIGNIN.display = 'd-hidden';\r\n               return f2\r\n          case VIEWS.VIEW_AUTH.value:\r\n               const f3 = VIEWS\r\n               f3.VIEW_CHAT.display = 'd-hidden-chat';\r\n               f3.VIEW_LISTA_CHAT.display = 'd-hidden-chat';\r\n               f3.VIEW_AUTH.display = '';\r\n               f3.VIEW_LOGIN.display = 'd-hidden';\r\n               f3.VIEW_SIGNIN.display = 'd-hidden';\r\n               return f3\r\n          case VIEWS.VIEW_LOGIN.value:\r\n               const f4 = VIEWS;\r\n               f4.VIEW_CHAT.display = 'd-hidden-chat';\r\n               f4.VIEW_LISTA_CHAT.display = 'd-hidden-chat';\r\n               f4.VIEW_AUTH.display = 'd-hidden';\r\n               f4.VIEW_LOGIN.display = '';\r\n               f4.VIEW_SIGNIN.display = 'd-hidden';\r\n               return f4;\r\n          case VIEWS.VIEW_SIGNIN.value:\r\n               const f5 = VIEWS\r\n               f5.VIEW_CHAT.display = 'd-hidden-chat';\r\n               f5.VIEW_LISTA_CHAT.display = 'd-hidden-chat';\r\n               f5.VIEW_AUTH.display = 'd-hidden';\r\n               f5.VIEW_LOGIN.display = 'd-hidden';\r\n               f5.VIEW_SIGNIN.display = '';\r\n               return f5;\r\n          default:\r\n               return state\r\n     }\r\n}\r\n\r\nexport const contextExample = {\r\n     setView: (arg0: paramView) => { },\r\n     activeChatId: '',\r\n     setActiveChatId: (arg0: string) => { },\r\n}\r\n\r\nexport const context = React.createContext(contextExample);","import React, { useContext } from 'react';\r\nimport logoutImage from '../../images/logout.png';\r\nimport fotoPerfil from '../../images/foto-perfil.png';\r\nimport { useSelector } from 'react-redux';\r\nimport { State } from '../../redux/types';\r\nimport { UserState } from '../../redux/types/users';\r\nimport { context, VIEWS } from '../Background/BackgroundReducer';\r\n\r\nfunction Head() {\r\n     const userState: UserState = useSelector((state: State) => state.user);\r\n     const { setView } = useContext(context);\r\n     \r\n     function logOut() {\r\n          localStorage.removeItem('token');\r\n          setView(VIEWS.VIEW_LOGIN.value);\r\n     }\r\n\r\n     return (\r\n          <div className=\"bg-primary d-flex justify-content-between px-4 py-3 border-shadow-title\" >\r\n               <div className=''>\r\n                    <h3 className='c-white'>Chat App</h3>\r\n                    <span className='c-white '>{userState.result.username}</span>\r\n               </div>\r\n               <div className='d-flex align-items-center'>\r\n                    <img src={fotoPerfil} alt=\"foto de perfil\" width='70px' className='rounded-circle mx-2' />\r\n                    <img src={logoutImage} alt=\"cerrar sesion\" width='30px' height='30px' className='mx-2 hover' onClick={logOut} />\r\n               </div>\r\n          </div>\r\n     )\r\n}\r\n\r\nexport default Head;","\r\n\r\n\r\n\r\nexport enum searchUsersEnumThunk {\r\n\r\n     SEARCH_USER_API_SUCESSS = 'SEARCH_USER_API_SUCESSS',\r\n     SEARCH_USER_API_STARTED = 'SEARCH_USER_API_STARTED',\r\n     SEARCH_USER_API_ERROR = 'SEARCH_USER_API_ERROR',\r\n}\r\n\r\n\r\nexport enum searchUsersEnum {\r\n     SET_USERS_SEARCH_MODE_ACTIVE_SYNC = 'SET_USERS_SEARCH_MODE_ACTIVE_SYNC',\r\n     SET_INDEX_USER_SEARCHED_SELECTED = 'SET_INDEX_USER_SEARCHED_SELECTED'\r\n}","import { UsersSearchAction } from \"../../types/usersSearch\";\r\nimport { searchUsersEnum } from '../../enums/searchUsersEnum';\r\n\r\nexport const setIndexUserSearchedSelectedAction = (index: number): UsersSearchAction => ({\r\n     type: searchUsersEnum.SET_INDEX_USER_SEARCHED_SELECTED,\r\n     payload: { indexUserSearchedSelected: index }\r\n});\r\n\r\n\r\n","import axios, { } from 'axios'\r\nimport { AxiosError } from 'axios'\r\n\r\nexport type { AxiosError }\r\n\r\nconst axiosClient = axios.create({\r\n    baseURL: process.env.REACT_APP_HOST_PC,\r\n})\r\n\r\nexport default axiosClient;","import { AxiosResponse, AxiosError } from 'axios'\r\nimport axiosClient from '../customAxios'\r\nimport IUser from '../types/User'\r\n\r\n\r\nexport function getUserByIdApi(\r\n     userId: string,\r\n     callbackSuccess?: (user: IUser) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n) {\r\n     axiosClient.get(`user/${userId}`)\r\n          .then((res: AxiosResponse<IUser>) => (callbackSuccess) && callbackSuccess(res.data))\r\n          .catch(error => {\r\n               callbackError && callbackError(error);\r\n               console.log(error.response?.data);\r\n          })\r\n}\r\n\r\nexport const userExistsFetch = async (username: string) => {\r\n     try {\r\n\r\n          const userExistsFetch = await axiosClient.get('user/', { params: { username } });\r\n          return userExistsFetch.data[0] ? true : false;\r\n\r\n     } catch (error) {\r\n          console.log(`Verifing user exists. Error ${error.response?.data}`);\r\n          return null;\r\n     }\r\n}\r\n\r\nexport const getUserByToken = async (token: string) => {\r\n     try {\r\n          const userExistsFetch = await axiosClient.get('user/', { params: { token } });\r\n          const { user } = userExistsFetch.data;\r\n          return user;\r\n     } catch (error) {\r\n          console.log(`Getting user by token. Error ${error.response?.data}`);\r\n          return null;\r\n     }\r\n}\r\n\r\nexport function getUsersByUsernameApi(\r\n     username: string,\r\n     callbackSuccess?: (user: IUser[]) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n\r\n     axiosClient.get('/user', { params: { username } })\r\n          .then((res: AxiosResponse<IUser[]>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               console.log(`Getting user by name. Error ${error.response?.data}`);\r\n               callbackError && callbackError(error);\r\n          })\r\n}\r\n\r\nexport function setUserActiveApi(\r\n     userId: string,\r\n     active: boolean,\r\n     callbackSuccess?: (userUpdated: IUser) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n     const bodyParam = {\r\n          field: 'active',\r\n          value: active\r\n     }\r\n     axiosClient.put('/user/' + userId, bodyParam)\r\n          .then((res: AxiosResponse<IUser>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               console.log(`Getting user by name. Error ${error.response?.data}`);\r\n               callbackError && callbackError(error);\r\n          })\r\n}\r\n","import { UsersSearchAction, UsersSearchDispatch } from \"../../types/usersSearch\";\r\nimport { State } from \"../../types\";\r\nimport IUser from \"../../../types/User\";\r\nimport { setIndexUserSearchedSelectedAction } from \"./setIndexUserSearchedSelectedAction\";\r\nimport { getUsersByUsernameApi } from \"../../../services/userServices\";\r\nimport { searchUsersEnumThunk } from '../../enums/searchUsersEnum'\r\n\r\n\r\nconst searchUserApiStarted = (): UsersSearchAction => ({\r\n     type: searchUsersEnumThunk.SEARCH_USER_API_STARTED,\r\n     payload: {}\r\n});\r\n\r\nconst searchUserApiSuccess = (dataUsers: IUser[]): UsersSearchAction => ({\r\n     type: searchUsersEnumThunk.SEARCH_USER_API_SUCESSS,\r\n     payload: { usersSearchData: dataUsers }\r\n});\r\n\r\nconst searchUserApiError = (error: Error): UsersSearchAction => ({\r\n     type: searchUsersEnumThunk.SEARCH_USER_API_ERROR,\r\n     payload: { error }\r\n});\r\n\r\nexport const searchUsersByusernameAction = (username: string) => (dispatch: UsersSearchDispatch, getState: () => State) => {\r\n     dispatch(searchUserApiStarted());\r\n     // when search it the users the index user put it in -1\r\n     dispatch(setIndexUserSearchedSelectedAction(-1));\r\n\r\n     getUsersByUsernameApi(\r\n          username,\r\n          res => dispatch(searchUserApiSuccess(res)),\r\n          error => dispatch(searchUserApiError(error))\r\n     );\r\n}\r\n","import { UsersSearchAction } from \"../../types/usersSearch\";\r\nimport { searchUsersEnum } from '../../enums/searchUsersEnum';\r\n\r\nexport const setUsersSearchModeActivesSyncAction = (active: boolean): UsersSearchAction => ({\r\n     type: searchUsersEnum.SET_USERS_SEARCH_MODE_ACTIVE_SYNC,\r\n     payload: { active }\r\n})\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useDebounce } from 'use-debounce/lib';\r\nimport { searchUsersByusernameAction } from '../../redux/actions/SearchUsersActions/searchUsersApiAction';\r\nimport { setUsersSearchModeActivesSyncAction } from '../../redux/actions/SearchUsersActions/setUsersSearchActiveModeAction';\r\nimport { State } from '../../redux/types';\r\nimport { UsersSearchState } from '../../redux/types/usersSearch';\r\n\r\nfunction Searcher() {\r\n     // texto del input search\r\n     const [inputSearch, setInputSearch] = useState('');\r\n     // debounce para que se haga la solicitud al api cuando el usuario termine de escribir\r\n     const [debounceInputSearch] = useDebounce(inputSearch, 800);\r\n     const [showSpinnerLoading, setShowSpinnerLoading] = useState(0);\r\n     const dispatch = useDispatch();\r\n     const searchUsersState: UsersSearchState = useSelector((state: State) => state.searchUsers);\r\n\r\n     useEffect(() => {\r\n          if (!searchUsersState.loading) {\r\n               setTimeout(() => setShowSpinnerLoading(-1), 500);\r\n          }\r\n     }, [searchUsersState.loading]);\r\n\r\n     // efecto para cuando el usuario termine de escribir en el input search se haga fetch a la API\r\n     useEffect(() => {\r\n          (async () => {\r\n               // validacion para que no haga el fetch cuando cargue el componente principalmente y tambien para que no haga fetch si el usuario no tiene nada\r\n               if (inputSearch === '') {\r\n                    // cambiamos el modo a no search para que renderize nuestros propios usuarios\r\n                    dispatch(setUsersSearchModeActivesSyncAction(false));\r\n                    dispatch(searchUsersByusernameAction(''));\r\n               } else {\r\n                    // cambiamos el modo a search para que renderize los usuarios buscados\r\n                    dispatch(setUsersSearchModeActivesSyncAction(true));\r\n                    dispatch(searchUsersByusernameAction(inputSearch));\r\n               }\r\n          })();\r\n     }, [debounceInputSearch]);\r\n\r\n     // this two effects is for show/hidde spinner when it search to user\r\n     useEffect(() => {\r\n          setShowSpinnerLoading(0);\r\n     }, [inputSearch]);\r\n\r\n     function handlerInputSearch(e: React.ChangeEvent<HTMLInputElement>) {\r\n          const value = e.currentTarget.value;\r\n          setInputSearch(value);\r\n     }\r\n\r\n     return (\r\n          <div className='pb-2 py-1'>\r\n               {/* SPINNER */}\r\n               <div className='d-flex justify-content-center align-items-center' style={{ zIndex: showSpinnerLoading, position: 'absolute', width: '100%', height: '100%' }}>\r\n                    <div className=\"spinner-border ml-2 text-primary\" style={{ width: 60, height: 60 }} />\r\n               </div>\r\n               {/* FAKE INPUT FOR PREVENT SAVE PASSWORD */}\r\n               <input type=\"password\" id=\"prevent_autofill\" autoComplete=\"off\" style={{ display: 'none' }} tabIndex={-1} />\r\n               <div className=\"input-group mb-3\">\r\n                    <input value={inputSearch} onChange={handlerInputSearch} className='form-control' placeholder='Buscar Chat o Usuarios'\r\n                         style={{ backgroundColor: '#F8F9F9' }} />\r\n                    <button className=\"btn btn-danger\" type=\"button\" onClick={() => setInputSearch('')}>X</button>\r\n               </div>\r\n\r\n          </div>\r\n     )\r\n}\r\n\r\nexport default Searcher;","export enum chatUpdateEnum {\r\n     NEW_MESSAGE,\r\n     DELETE_MESSAGE,\r\n};\r\n\r\nexport const UPDATE_CHAT = 'UPDATE_CHAT';\r\nexport type UPDATE_CHAT = typeof UPDATE_CHAT;\r\n\r\n\r\nexport const DELETE_CHAT = 'DELETE_CHAT';\r\nexport type DELETE_CHAT = typeof DELETE_CHAT;\r\n\r\n\r\nexport enum chatUpdateThunk {\r\n     UPDATE_CHAT_API_STARTED = \"UPDATE_CHAT_API_STARTED\",\r\n     UPDATE_CHAT_API_SUCESSS = 'UPDATE_CHAT_API_SUCESSS',\r\n     UPDATE_CHAT_API_ERROR = 'UPDATE_CHAT_API_ERROR'\r\n}\r\n\r\nexport enum chatFindThunk {\r\n     FIND_CHAT_API_STARTED = 'FIND_CHAT_API_STARTED',\r\n     FIND_CHAT_API_SUCESSS = 'FIND_CHAT_API_SUCESSS',\r\n     FIND_CHAT_API_ERROR = 'FIND_CHAT_API_ERROR'\r\n}\r\n\r\nexport enum chatDeleteThunk {\r\n     DELETE_CHAT_API_STARTED = 'DELETE_CHAT_API_STARTED',\r\n     DELETE_CHAT_API_SUCESSS = 'DELETE_CHAT_API_SUCESSS',\r\n     DELETE_CHAT_API_ERROR = 'DELETE_CHAT_API_ERROR'\r\n}\r\n\r\n","import IUser from './User'\r\n\r\n\r\nexport interface IMessage {\r\n     _id?: string\r\n     author: IUser,\r\n     text: string,\r\n     date: Date\r\n}\r\n\r\nexport default interface Chat {\r\n     _id?: string\r\n     members: IUser[] ,\r\n     createdAt: Date,\r\n     author:  string,\r\n     messages: IMessage[] \r\n}\r\n\r\nexport const chatExampleObject: Chat = {\r\n     author: ``,\r\n     createdAt: new Date(),\r\n     members: [],\r\n     messages: [],\r\n}","import { AxiosResponse } from 'axios';\r\nimport axiosClient from '../customAxios';\r\nimport { IChat } from '../redux/types/chat';\r\nimport { chatExampleObject, IMessage } from '../types/Chat';\r\nimport { AxiosError } from 'axios'\r\nimport { IChats } from '../redux/types/chats';\r\n\r\n\r\nexport function insertNewMessage(\r\n     chatId: string, message: IMessage,\r\n     callbackSuccess?: (data?: IChat) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n     const body = {\r\n          \"field\": \"messages\",\r\n          \"value\": {\r\n               type: \"PUSH\",\r\n               value: message\r\n          }\r\n     }\r\n     axiosClient.put('/chat/' + chatId, body)\r\n          .then((res: AxiosResponse<IChat>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               console.log(`Inserting new message. Error ${error.response?.data}`);\r\n               callbackError && callbackError(error)\r\n          });\r\n\r\n}\r\n\r\nexport function createNewChat(\r\n     memberId1: string, memberId2: string, callbackSuccess?: (data: IChat) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n\r\n     const newChat = {\r\n          ...chatExampleObject,\r\n          author: memberId1,\r\n          members: [memberId1, memberId2]\r\n     };\r\n\r\n     axiosClient.post('/chat', newChat)\r\n          .then((res: AxiosResponse<IChat>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               callbackError && callbackError(error);\r\n               console.log(`Creating new chat. Error ${error.response?.data}`);\r\n          })\r\n\r\n}\r\n\r\nexport function deleteChatApi(\r\n     chatId: string, callbackSuccess?: (chats: IChats) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n     axiosClient.delete('/chat/' + chatId)\r\n          .then((res: AxiosResponse<IChats>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               console.log(`Deleting chat. Error ${error.response?.data}`);\r\n               callbackError && callbackError(error)\r\n          });\r\n\r\n}\r\n\r\nexport function deleteMessageAPI(\r\n     chatId: string, messageId: string, callbackSuccess?: (chat: IChat) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n     const bodyParam = {\r\n          field: 'messages',\r\n          value: {\r\n               type: 'DELETE',\r\n               value: messageId\r\n          }\r\n     }\r\n\r\n     axiosClient.put('/chat/' + chatId, bodyParam)\r\n          .then((res: AxiosResponse<IChat>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               console.log(`delete message. Error ${error.response?.data}`);\r\n               callbackError && callbackError(error)\r\n          });\r\n}\r\n\r\nexport function getChatsApi(\r\n     anyMemberId: string,\r\n     callbackSuccess?: (chats: IChat[]) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n     const params = {\r\n          params: {\r\n               member1: anyMemberId\r\n          }\r\n     }\r\n     axiosClient.get('/chat', params)\r\n          .then((res: AxiosResponse<IChat[]>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               callbackError && callbackError(error);\r\n               console.log(`delete message. Error ${error.response?.data}`);\r\n          })\r\n}\r\n\r\nexport function getChatApi(\r\n     chatId: string,\r\n     callbackSuccess?: (chats: IChat) => void,\r\n     callbackError?: (error: AxiosError) => void\r\n): void {\r\n\r\n     axiosClient.get('/chat/' + chatId)\r\n          .then((res: AxiosResponse<IChat>) => callbackSuccess && callbackSuccess(res.data))\r\n          .catch((error: AxiosError) => {\r\n               callbackError && callbackError(error);\r\n               console.log(`delete message. Error ${error.response?.data}`);\r\n          });\r\n}\r\n\r\n","import { State } from '../../types';\r\nimport { ChatAction, IChat, ChatDispatch } from '../../types/chat';\r\nimport { getChatApi } from '../../../services/chatServices';\r\nimport { chatFindThunk } from '../../enums/chatEnums';\r\n\r\nexport const FIND_CHAT_API_SUCESSS = 'FIND_CHAT_API_SUCESSS';\r\nexport const FIND_CHAT_API_STARTED = 'FIND_CHAT_API_STARTED';\r\nexport const FIND_CHAT_API_ERROR = 'FIND_CHAT_API_ERROR';\r\n\r\nconst findChatApiStarted = (): ChatAction => ({\r\n     type: chatFindThunk.FIND_CHAT_API_STARTED,\r\n});\r\n\r\nconst findChatApiSuccess = (res: IChat): ChatAction => ({\r\n     type: chatFindThunk.FIND_CHAT_API_SUCESSS,\r\n     payload: res\r\n});\r\n\r\nconst findChatApiError = (error: Error): ChatAction => ({\r\n     type: chatFindThunk.FIND_CHAT_API_ERROR,\r\n     payload: error\r\n});\r\n\r\nexport const findChatAction = (chatId: string) => (dispatch: ChatDispatch, getState: () => State) => {\r\n\r\n     dispatch(findChatApiStarted());\r\n\r\n     // gettin all chats in the found user\r\n     getChatApi(chatId,\r\n          (chat: IChat) => dispatch(findChatApiSuccess(chat)),\r\n          (error: Error) => dispatch(findChatApiError(error))\r\n     );\r\n}\r\n\r\n\r\n\r\n\r\n","import React, { useContext, useEffect } from 'react'\r\nimport fotoPerfil from '../../images/foto-perfil.png'\r\nimport { context, VIEWS } from '../Background/BackgroundReducer'\r\n\r\ninterface IChatCard {\r\n    urlImageProfile: string,\r\n    name: string,\r\n    text: string\r\n}\r\n\r\nconst ChatCard = ({ name, urlImageProfile, text }: IChatCard) => {\r\n\r\n    const { setView } = useContext(context)\r\n\r\n    const handler = () => {\r\n        setView(VIEWS.VIEW_CHAT.value);\r\n    }\r\n\r\n    return (\r\n        <div className=' pr-2 pl-1 mb-3 '  onClick={handler} >\r\n            <div className='d-flex flex-nowrap border-shadow w-100 my-2 p-2 overflow-hidden' style={{ backgroundColor: '#F9F6FA' }}>\r\n                <div className='mx-2'>\r\n                    <img src={fotoPerfil} className='rounded-circle ' width='50px' alt=\"foto del contacto\" />\r\n                </div>\r\n                <div className='mx-2'>\r\n                    <label className='w-100 fw-bold my-0'>{name}</label>\r\n                    <span className='w-100 fs-12 my-0  t-0'>{text}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ChatCard","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { findChatAction } from '../../../redux/actions/chatActions/findChatApiAction';\r\nimport { State } from '../../../redux/types';\r\nimport { ChatsState } from '../../../redux/types/chats';\r\nimport { UserState } from '../../../redux/types/users';\r\nimport ChatCard from '../ChatCard';\r\n\r\nfunction LoadMySelfChats() {\r\n     \r\n     const chatsState: ChatsState = useSelector((state: State) => state.chats);\r\n     const dispatch = useDispatch();\r\n     const setChatActive = (chatId: string | undefined) => dispatch(findChatAction(chatId as string));\r\n     const userState: UserState = useSelector((state: State) => state.user);\r\n\r\n     return (\r\n          <>\r\n               {/* CARGANDO CHATS PROPIOS */}\r\n               <label>Mis Chats</label>\r\n               {chatsState.result.map(chat => {\r\n                    const member = chat.members[1];\r\n                    const lastMessage = chat.messages[chat.messages.length - 1];\r\n\r\n                    const f = chat;\r\n                    const username = f.members[0].username === userState.result.username ? f.members[1].username : f.members[0].username;\r\n                    return (\r\n                         member ?\r\n                              (<div key={chat._id} onClick={() => setChatActive(chat._id)}>\r\n                                   <ChatCard name={username} urlImageProfile={member.imageProfile} text={lastMessage && lastMessage.text} />\r\n                              </div>) : <></>\r\n                    )\r\n               })}\r\n          </>\r\n     )\r\n}\r\n\r\nexport default LoadMySelfChats;","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { setIndexUserSearchedSelectedAction } from '../../../redux/actions/SearchUsersActions/setIndexUserSearchedSelectedAction';\r\nimport { State } from '../../../redux/types';\r\nimport { UsersSearchState } from '../../../redux/types/usersSearch';\r\nimport ChatCard from '../ChatCard';\r\n\r\n\r\n\r\nfunction SearchingUsers() {\r\n     const searchUsersState: UsersSearchState = useSelector((state: State) => state.searchUsers);\r\n     const dispatch = useDispatch();\r\n     \r\n     function setChatFinded(index: number) {\r\n          dispatch(setIndexUserSearchedSelectedAction(index));\r\n     }\r\n\r\n     return (\r\n          <div>\r\n               <label className='border p-3 pr-5 w-100' style={{ backgroundColor: '#3498DB', color: 'white', borderRadius: 5 }}>\r\n                    Buscando usuarios...\r\n                            </label>\r\n               {searchUsersState.result.UsersSearchData !== null &&\r\n                    (\r\n                         // if exists the user writed then it print in screen\r\n                         (searchUsersState.result.UsersSearchData.length !== 0)\r\n                              ? (\r\n                                   searchUsersState.result.UsersSearchData.map((user, index) => (\r\n                                        <div key={user._id} onClick={() => setChatFinded(index)} >\r\n                                             <ChatCard name={user.username} urlImageProfile={user.imageProfile} text={'Estoy disponible en Chat App'} />\r\n                                        </div>\r\n                                   ))\r\n                                   // do not exists the user writed \r\n                              ) : <div className='mt-3'>No se encontro este usuario...</div>\r\n                    )\r\n               }\r\n          </div>\r\n     )\r\n}\r\n\r\nexport default SearchingUsers;","import React from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { State } from '../../redux/types/index';\r\nimport { UsersSearchState } from '../../redux/types/usersSearch';\r\nimport Head from './Head';\r\nimport Searcher from './Searcher';\r\nimport LoadMySelfChats from './body/LoadMySelfChats';\r\nimport SearchingUsers from './body/SearchingUsers';\r\nfunction ViewListaChat() {\r\n\r\n    // const chatState: ChatState = useSelector((state: State) => state.chat);\r\n    const searchUsersState: UsersSearchState = useSelector((state: State) => state.searchUsers);\r\n\r\n    return (\r\n        <div className='view-lista-chat-container' style={{ backgroundColor: 'white' }}>\r\n            <Head />\r\n            <div className=\"mt-1\">\r\n                <Searcher />\r\n                {/* CHATS CONTAINER */}\r\n                <div className='border p-3' style={{ height: '80vh', overflow: 'auto' }}>\r\n                    {searchUsersState.result.usersSearchModeActive ? (\r\n                        <SearchingUsers />\r\n                    ) : (\r\n                        <LoadMySelfChats />\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div >\r\n\r\n    )\r\n}\r\n\r\nexport default ViewListaChat;","import React, { useContext } from 'react';\r\nimport { Dropdown } from 'react-bootstrap';\r\nimport fotoPerfil from '../../images/foto-perfil.png';\r\nimport fotoBack from '../../images/previous.png';\r\nimport { ChatState } from '../../redux/types/chat';\r\nimport { UserState } from '../../redux/types/users';\r\nimport { UsersSearchState } from '../../redux/types/usersSearch';\r\nimport { useSelector } from 'react-redux';\r\nimport { State } from '../../redux/types';\r\nimport { VIEWS, context } from '../Background/BackgroundReducer';\r\n\r\ninterface IProps {\r\n     setShowModal: (arg0: boolean) => void\r\n}\r\n\r\nfunction Head({ setShowModal }: IProps) {\r\n     const chatState: ChatState = useSelector((state: State) => state.chat);\r\n     const searchUsersState: UsersSearchState = useSelector((state: State) => state.searchUsers);\r\n     const userState: UserState = useSelector((state: State) => state.user);\r\n     const { setView } = useContext(context);\r\n\r\n     function getUsername() {\r\n          if (searchUsersState.result.usersSearchModeActive) {\r\n               const userSearchedSelected = searchUsersState.result.UsersSearchData[searchUsersState.result.indexUserSearchedSelected];\r\n               return userSearchedSelected && userSearchedSelected.username;\r\n          } else {\r\n               if (chatState.result && chatState.result.author !== '') {\r\n                    // getting correct username. the API return two members\r\n                    const f = chatState.result;\r\n                    return f.members[0].username === userState.result.username ? f.members[1].username : f.members[0].username;\r\n               }\r\n          }\r\n     }\r\n     function getActive() {\r\n          if (searchUsersState.result.usersSearchModeActive) {\r\n               const userSearchedSelected = searchUsersState.result.UsersSearchData[searchUsersState.result.indexUserSearchedSelected];\r\n               return userSearchedSelected && userSearchedSelected.active ? 'Activo' : 'Inactivo';\r\n          } else {\r\n               if (chatState.result && chatState.result.members.length > 0) {\r\n                    return chatState.result && chatState.result.members[1].active ? 'Activo' : 'Inactivo'\r\n               }\r\n          }\r\n     }\r\n     function handlerSetView() {\r\n          setView(VIEWS.VIEW_LISTA_CHAT.value);\r\n     }\r\n\r\n     return (\r\n          <div className='bg-primary d-flex  py-3 border-shadow-title justify-content-between'>\r\n               <div className=' d-flex flex-nowrap'>\r\n                    <div className='my-2 mx-3 d-flex hover' onClick={handlerSetView}>\r\n                         <img src={fotoBack} alt=\"\" width='35px' />\r\n                    </div>\r\n                    <div className='d-flex flex-nowrap '>\r\n                         <div className='ml-1'>\r\n                              <img src={fotoPerfil} className='rounded-circle' width='50px' alt=\"foto del contacto\" />\r\n                         </div>\r\n                         <div className='mx-2'>\r\n                              <label className='w-100 fw-bold my-0 c-white'>{getUsername()}</label>\r\n                              <span className='w-100 fs-12 my-0 c-white t-0'>{getActive()}</span>\r\n                         </div>\r\n                    </div>\r\n               </div>\r\n               <div className=\"m-2\">\r\n                    <Dropdown>\r\n                         <Dropdown.Toggle variant=\"secondary\"></Dropdown.Toggle>\r\n                         <Dropdown.Menu>\r\n                              <Dropdown.Item onClick={() => setShowModal(true)}>Eliminar Chat</Dropdown.Item>\r\n                         </Dropdown.Menu>\r\n                    </Dropdown>\r\n               </div>\r\n          </div>\r\n     )\r\n}\r\n\r\nexport default Head;","export default \"data:image/png;base64,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\"","import io from 'socket.io-client';\r\n\r\n\r\nconst host: string = process.env.REACT_APP_HOST_PC as string;\r\nconst socket = io(host);\r\n\r\n\r\n\r\nexport default socket;","import { UPDATE_CHAT } from '../../enums/chatEnums';\r\nimport { ChatAction, IChat } from '../../types/chat';\r\n\r\nexport function updateChatAction(chat: IChat): ChatAction {\r\n     return ({\r\n          type: UPDATE_CHAT,\r\n          payload: chat\r\n     });\r\n}\r\n","export const INSERT_CHAT = 'INSERT_CHAT'\r\nexport type INSERT_CHAT = 'INSERT_CHAT'\r\n\r\nexport enum findChatsEnumThunk {\r\n\r\n     FIND_CHATS_API_SUCESSS = 'FIND_CHATS_API_SUCESSS',\r\n     FIND_CHATS_API_STARTED = 'FIND_CHATS_API_STARTED',\r\n     FIND_CHATS_API_ERROR = 'FIND_CHATS_API_ERROR'\r\n\r\n}\r\n\r\nexport enum chatInsertThunk {\r\n     INSERT_CHAT_API_STARTED = 'INSERT_CHAT_API_STARTED',\r\n     INSERT_CHAT_API_SUCESSS = 'INSERT_CHAT_API_SUCESSS',\r\n     INSERT_CHAT_API_ERROR = 'INSERT_CHAT_API_ERROR'\r\n}\r\n\r\n\r\nexport const UPDATE_CHATS = 'UPDATE_CHATS';\r\nexport const DELETE_CHAT = 'DELETE_CHAT';","import { IChat } from \"../../types/chat\";\r\nimport { UPDATE_CHATS } from '../../enums/chatsEnums';\r\nimport { ChatsAction } from \"../../types/chats\";\r\n\r\nexport function updateChatsAction(chatId: string, chat: IChat): ChatsAction {\r\n     return ({\r\n          type: UPDATE_CHATS,\r\n          payload: {\r\n               chat, chatId\r\n          }\r\n     });\r\n};\r\n\r\n\r\n\r\n","\r\nexport enum findUserEnumThunk {\r\n\r\n     FIND_USER_API_SUCCESS = 'FIND_USER_API_SUCCESS',\r\n     FIND_USER_API_ERROR = 'FIND_USER_API_ERROR',\r\n     FIND_USER_API_STARTED = 'FIND_USER_API_STARTED'\r\n}\r\n\r\nexport enum updateUserEnumThunk {\r\n\r\n     UPDATE_USER_API_SUCCESS = 'UPDATE_USER_API_SUCCESS',\r\n     UPDATE_USER_API_ERROR = 'UPDATE_USER_API_ERROR',\r\n     UPDATE_USER_API_STARTED = 'UPDATE_USER_API_STARTED'\r\n}\r\n\r\nexport enum updateUserEnum {  \r\n\r\n     SET_PASSWORD = 'SET_PASSWORD',\r\n     SET_ACTIVE = 'SET_ACTIVE',\r\n     SET_IMAGE_PROFILE = 'SET_IMAGE_PROFILE',\r\n     ADD_CONTACT = 'ADD_CONTACT',\r\n     DELETE_CONTACT = 'DELETE_CONTACT'\r\n}\r\n","import { UserState, UserAction, IUser } from '../types/users';\r\nimport { updateUserEnumThunk, findUserEnumThunk } from '../enums/userEnum'\r\n\r\nconst initialState: UserState = {\r\n     error: null,\r\n     loading: false,\r\n     result: {\r\n          active: false,\r\n          contacts: [],\r\n          imageProfile: '',\r\n          username: ''\r\n     }\r\n}\r\nfunction reducer(state = initialState, action: UserAction): UserState {\r\n     switch (action.type) {\r\n          case findUserEnumThunk.FIND_USER_API_STARTED:\r\n               return { ...state, loading: true }\r\n\r\n          case findUserEnumThunk.FIND_USER_API_SUCCESS:\r\n               return { ...state, loading: false, result: action.payload as IUser }\r\n\r\n          case findUserEnumThunk.FIND_USER_API_ERROR:\r\n               return { ...state, loading: false, error: action.payload as Error }\r\n\r\n          case updateUserEnumThunk.UPDATE_USER_API_STARTED:\r\n               return { ...state, loading: true }\r\n\r\n          case updateUserEnumThunk.UPDATE_USER_API_SUCCESS:\r\n               return { ...state, loading: false, result: action.payload as IUser }\r\n\r\n          case updateUserEnumThunk.UPDATE_USER_API_ERROR:\r\n               return { ...state, loading: false, error: action.payload as Error }\r\n\r\n          default:\r\n               return state;\r\n     }\r\n\r\n}\r\n\r\nexport default reducer","import { ChatsAction, ChatsState, IChats } from '../types/chats';\r\nimport { DELETE_CHAT, findChatsEnumThunk, UPDATE_CHATS, chatInsertThunk, INSERT_CHAT } from '../enums/chatsEnums';\r\nimport { IChat } from '../types/chat';\r\n\r\nconst initialState: ChatsState = {\r\n     error: null,\r\n     loading: false,\r\n     result: []\r\n}\r\n\r\nfunction reducer(state = initialState, action: ChatsAction): ChatsState {\r\n     switch (action.type) {\r\n          case findChatsEnumThunk.FIND_CHATS_API_STARTED:\r\n               return { ...state, loading: true }\r\n          case findChatsEnumThunk.FIND_CHATS_API_SUCESSS:\r\n               return { ...state, loading: false, result: action.payload as IChats }\r\n          case findChatsEnumThunk.FIND_CHATS_API_ERROR:\r\n               return { ...state, loading: false, error: action.payload as Error }\r\n\r\n          case chatInsertThunk.INSERT_CHAT_API_STARTED:\r\n               return { ...state, loading: true }\r\n          case chatInsertThunk.INSERT_CHAT_API_SUCESSS:\r\n               return { ...state, loading: false, result: [...state.result, action.payload as IChat] }\r\n          case chatInsertThunk.INSERT_CHAT_API_ERROR:\r\n               return { ...state, loading: false, error: action.payload as Error }\r\n\r\n          case UPDATE_CHATS:\r\n               return {\r\n                    ...state,\r\n                    result: state.result.map(chat => {\r\n                         if (chat._id == action.payload.chatId) {\r\n                              return action.payload.chat\r\n                         }\r\n                         return chat;\r\n                    })\r\n               }\r\n          case DELETE_CHAT:\r\n               return {\r\n                    ...state,\r\n                    result: state.result.filter(chat => chat._id !== action.payload)\r\n               }\r\n\r\n          case INSERT_CHAT:\r\n               return { ...state, result: [...state.result, action.payload] }\r\n\r\n          default:\r\n               return state;\r\n     }\r\n}\r\n\r\nexport default reducer","import { ChatAction, ChatState, IChat } from '../types/chat';\r\nimport store from '../';\r\nimport { chatUpdateThunk, chatDeleteThunk, chatFindThunk, UPDATE_CHAT, DELETE_CHAT } from '../enums/chatEnums';\r\n\r\n\r\nconst initialState: ChatState = {\r\n     error: null,\r\n     loading: false,\r\n     result: null\r\n}\r\n\r\nfunction reducer(state = initialState, action: ChatAction): ChatState {\r\n     if (store) {\r\n          switch (action.type) {\r\n\r\n               case chatFindThunk.FIND_CHAT_API_STARTED:\r\n                    return { ...state, loading: true }\r\n               case chatFindThunk.FIND_CHAT_API_SUCESSS:\r\n                    return { ...state, loading: false, result: action.payload as IChat }\r\n               case chatFindThunk.FIND_CHAT_API_ERROR:\r\n                    return { ...state, loading: false, error: action.payload as Error }\r\n\r\n               case chatUpdateThunk.UPDATE_CHAT_API_STARTED:\r\n                    return { ...state, loading: true }\r\n               case chatUpdateThunk.UPDATE_CHAT_API_SUCESSS:\r\n                    return { ...state, loading: false, result: action.payload as IChat }\r\n               case chatUpdateThunk.UPDATE_CHAT_API_ERROR:\r\n                    return { ...state, loading: false, error: action.payload as Error }\r\n\r\n               case chatDeleteThunk.DELETE_CHAT_API_STARTED:\r\n                    return { ...state, loading: true }\r\n               case chatDeleteThunk.DELETE_CHAT_API_SUCESSS:\r\n                    return { ...state, loading: false, result: null }\r\n               case chatDeleteThunk.DELETE_CHAT_API_ERROR:\r\n                    return { ...state, loading: false, error: action.payload as Error }\r\n\r\n               case DELETE_CHAT:\r\n                    return { ...state, result: null }\r\n\r\n\r\n               case UPDATE_CHAT:\r\n                    return { ...state, result: action.payload as IChat };\r\n\r\n          }\r\n     }\r\n     return state;\r\n}\r\n\r\nexport default reducer;","import { UsersSearchState, UsersSearchAction } from '../types/usersSearch';\r\nimport { IUser } from '../types/users';\r\nimport { searchUsersEnumThunk, searchUsersEnum } from '../enums/searchUsersEnum'\r\n\r\n\r\nconst initialState: UsersSearchState = {\r\n     error: null,\r\n     loading: false,\r\n     result: {\r\n          UsersSearchData: [],\r\n          usersSearchModeActive: false,\r\n          indexUserSearchedSelected: -1\r\n     }\r\n}\r\n\r\nfunction reducer(state = initialState, action: UsersSearchAction): UsersSearchState {\r\n\r\n\r\n     switch (action.type) {\r\n          case searchUsersEnumThunk.SEARCH_USER_API_STARTED:\r\n               return { ...state, loading: true }\r\n\r\n          case searchUsersEnumThunk.SEARCH_USER_API_SUCESSS:\r\n               return {\r\n                    ...state, loading: false, result: { ...state.result, UsersSearchData: action.payload.usersSearchData as IUser[] }\r\n               }\r\n          case searchUsersEnumThunk.SEARCH_USER_API_ERROR:\r\n               return { ...state, loading: false, error: action.payload.error as Error }\r\n          case searchUsersEnum.SET_USERS_SEARCH_MODE_ACTIVE_SYNC:\r\n               return { ...state, result: { ...state.result, usersSearchModeActive: action.payload.active as boolean } }\r\n\r\n          case searchUsersEnum.SET_INDEX_USER_SEARCHED_SELECTED:\r\n               return {\r\n                    ...state, result: { ...state.result, indexUserSearchedSelected: action.payload.indexUserSearchedSelected as number }\r\n               };\r\n\r\n          default:\r\n               return state;\r\n     }\r\n}\r\n\r\nexport default reducer","import { createStore, combineReducers, applyMiddleware } from 'redux';\r\nimport userReducer from './reducers/userReducer';\r\nimport chatsReducer from './reducers/chatsReducer';\r\nimport chatReducer from './reducers/chatReducer';\r\nimport UsersFindedReducer from './reducers/searchUsersReducer';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport thunk from 'redux-thunk';\r\nimport { CombineReducer } from './types';\r\n\r\n\r\nconst reducers: CombineReducer = combineReducers({\r\n     user: userReducer,\r\n     chats: chatsReducer,\r\n     chat: chatReducer,\r\n     searchUsers: UsersFindedReducer\r\n})\r\n\r\n\r\nexport default createStore(reducers, composeWithDevTools(applyMiddleware(thunk)));","import { Dispatch } from \"react\";\r\nimport { updateChatAction } from \"../../redux/actions/chatActions/updateChatAction\";\r\nimport { updateChatsAction } from \"../../redux/actions/chatsActions/updateChatsAction\";\r\nimport { IChat } from \"../../redux/types/chat\";\r\nimport store from '../../redux';\r\ninterface F { chat: IChat, userId: string }\r\n\r\nfunction newMessageListener({ userId, chat }: F) {\r\n     console.log('NEW MESSAGE: AHORA TO EL MUNDO QUIERE HACER TRAP COMO DOWBA');\r\n     const mySelfUserId = store.getState().user.result._id as string;\r\n     if (userId !== mySelfUserId) {\r\n          const dispatch: Dispatch<any> = store.dispatch;\r\n          const chatId: string = chat._id as string;\r\n          dispatch(updateChatAction(chat));\r\n          dispatch(updateChatsAction(chatId, chat));\r\n     }\r\n}\r\n\r\nexport default newMessageListener;","import { ChatsAction } from \"../../types/chats\";\r\nimport { DELETE_CHAT } from '../../enums/chatsEnums';\r\n\r\nexport function deleteChatsAction(chatId: string): ChatsAction {\r\n\r\n     return ({\r\n          type: DELETE_CHAT,\r\n          payload: chatId\r\n     });\r\n}","import { Dispatch, useContext } from 'react';\r\nimport store from '../../redux';\r\nimport deleteChatAction from './../../redux/actions/chatActions/deleteChatAction'\r\nimport { IChat } from '../../redux/types/chat';\r\nimport { deleteChatsAction } from '../../redux/actions/chatsActions/deleteChatAction';\r\nimport { context, paramView, VIEWS } from '../../components/Background/BackgroundReducer';\r\n\r\ninterface F { chat: IChat, userId: string }\r\n\r\nlet setView = (arg0: paramView) => { }\r\n\r\nconst F = () => {\r\n     const c = useContext(context);\r\n     setView = c.setView;\r\n}\r\n\r\nfunction deleteChatListener({ userId, chat }: F) {\r\n     console.log('Se ha recibido delete chat');\r\n     const mySelfUserId = store.getState().user.result._id as string;\r\n     const mySelfChat: IChat = store.getState().chat.result as IChat;\r\n\r\n     if (userId !== mySelfUserId) {\r\n          const dispatch: Dispatch<any> = store.dispatch;\r\n\r\n          if (mySelfChat._id == chat._id) {\r\n               dispatch(deleteChatAction())\r\n          }\r\n          dispatch(deleteChatsAction(chat._id as string));\r\n          setView(VIEWS.VIEW_LISTA_CHAT.value);\r\n          \r\n     }\r\n}\r\n\r\n\r\n\r\nexport default deleteChatListener;","import { DELETE_CHAT } from \"../../enums/chatEnums\";\r\nimport { ChatAction } from \"../../types/chat\";\r\n\r\n\r\n\r\n\r\nexport default function deleteChatAction(): ChatAction {\r\n     return ({\r\n          type: DELETE_CHAT\r\n     });\r\n}","import { IChat } from \"../../redux/types/chat\";\r\nimport store from '../../redux';\r\nimport { insertChatsAction } from \"../../redux/actions/chatsActions/insertChatAction\";\r\nimport { Dispatch } from \"react\";\r\n\r\ninterface F {\r\n     chat: IChat,\r\n     userId: string\r\n}\r\n\r\nfunction createChatListener({ chat, userId }: F) {\r\n     const mySelfUserId = store.getState().user.result._id as string;\r\n\r\n     if (mySelfUserId !== userId && !validation(chat._id as string)) {\r\n\r\n          const dispatch: Dispatch<any> = store.dispatch;\r\n          console.log('se recibio el crear un nuevo chat: ' + chat);\r\n          dispatch(insertChatsAction(chat));\r\n     }\r\n}\r\n\r\nfunction validation(chatId: string) {\r\n     // validate that this chat id do not exists in the view\r\n     const chats = store.getState().chats.result;\r\n     return chats.some(chat => chat._id as string == chatId);\r\n}\r\n\r\nexport default createChatListener;","import { IChat } from \"../../types/chat\";\r\nimport { INSERT_CHAT } from '../../enums/chatsEnums'\r\nimport { ChatsAction } from \"../../types/chats\";\r\n\r\nexport function insertChatsAction(chat: IChat): ChatsAction {\r\n     return ({\r\n          type: INSERT_CHAT,\r\n          payload: chat\r\n     });\r\n}\r\n\r\n","import { IChat } from \"../../redux/types/chat\";\r\nimport store from '../../redux';\r\nimport { updateChatAction } from \"../../redux/actions/chatActions/updateChatAction\";\r\nimport { updateChatsAction } from \"../../redux/actions/chatsActions/updateChatsAction\";\r\nimport { Dispatch } from \"redux\";\r\n\r\ninterface F {\r\n     chat: IChat, userId: string\r\n}\r\n\r\nfunction deleteMessageListener({ chat, userId }: F) {\r\n     console.log('se ha recibido evento de delete message');\r\n     const mySelfUserId = store.getState().user.result._id as string;\r\n     const mySelfChat: IChat = store.getState().chat.result as IChat;\r\n     if (userId !== mySelfUserId) {\r\n          const dispatch: Dispatch<any> = store.dispatch;\r\n          \r\n          if (mySelfChat._id == chat._id) {\r\n               dispatch(updateChatAction(chat));\r\n          }\r\n          dispatch(updateChatsAction(chat._id as string, chat));\r\n     }\r\n}\r\n\r\nexport default deleteMessageListener;","import socket from '../index';\r\nimport newMessageListener from './newMessageListener';\r\nimport deleteChatListener from './deleteChatListener';\r\nimport createChatListener from './createChatListener';\r\nimport { emiteCloseConnection } from '../emitters';\r\nimport deleteMessageListener from './deleteMessageListener';\r\n// here it will save the socket-id\r\nexport let socketId = '';\r\n\r\n\r\nsocket.on(\"connect\", () => {\r\n     socketId = socket.id;\r\n     console.log('my socketId is ' + socketId);\r\n});\r\n\r\n\r\nsocket.on('NEW_MESSAGE', newMessageListener);\r\n\r\nsocket.on('DELETE_CHAT', deleteChatListener);\r\n\r\nsocket.on('CREATE_CHAT', createChatListener);\r\n\r\nsocket.on('DELETE_MESSAGE', deleteMessageListener);","import socket from '../index';\r\nimport { socketId } from '../../socket/listeners/index';\r\nimport { INewMessageSocketEmit, INewConnectionSocketEmit, IDeleteChatSocketEmit, ICreateChatEmit, IDeleteMessageEmit } from '../../types/socket';\r\nimport { IChat } from '../../redux/types/chat';\r\n\r\nexport function sendNewNotificationMessageToServer(chatId: string) {\r\n\r\n     const toSend: INewMessageSocketEmit = {\r\n          chatId, socketId\r\n     };\r\n     socket.emit('NEW_MESSAGE', toSend);\r\n}\r\n\r\nexport function emiteNewConnection(userId: string) {\r\n\r\n     const toSend: INewConnectionSocketEmit = {\r\n          userId, socketId\r\n     };\r\n\r\n     socket.emit('NEW_CONNECTION', toSend);\r\n\r\n}\r\n\r\nexport function emitDeleteChat(chat: IChat) {\r\n     console.log('se ha emitido borrar chat')\r\n     const toSend: IDeleteChatSocketEmit = {\r\n          chat, socketId\r\n     };\r\n\r\n     socket.emit('DELETE_CHAT', toSend);\r\n}\r\n\r\nexport function emiteCreateChat(chat: IChat) {\r\n     console.log('Se ha emitido create chat');\r\n     const toSend: ICreateChatEmit = {\r\n          chat, socketId\r\n     };\r\n\r\n     socket.emit('CREATE_CHAT', toSend);\r\n}\r\n\r\nexport function emiteCloseConnection() {\r\n     console.log('Se ha emitido cerrar conexion');\r\n     socket.emit('CLOSE_CONNECTION', socketId);\r\n}\r\n\r\nexport function emiteDeleteMessage(chat: IChat) {\r\n     console.log('Se ha emitido borrar mensaje');\r\n     const toSend: IDeleteMessageEmit = { chat, socketId }\r\n     socket.emit('DELETE_MESSAGE', toSend);\r\n}","import { State } from '../../types';\r\nimport { ChatAction, IChat, IChatUpdate } from '../../types/chat';\r\nimport { IMessage } from '../../../types/Chat';\r\nimport { deleteMessageAPI, insertNewMessage } from '../../../services/chatServices';\r\nimport { emiteDeleteMessage, sendNewNotificationMessageToServer } from '../../../socket/emitters';\r\nimport { chatUpdateEnum, chatUpdateThunk } from '../../enums/chatEnums';\r\nimport { updateChatsAction } from '../chatsActions/updateChatsAction';\r\n\r\nconst updateChatApiStarted = (): ChatAction => ({\r\n     type: chatUpdateThunk.UPDATE_CHAT_API_STARTED,\r\n});\r\n\r\nconst updateChatApiSuccess = (chat: IChat): ChatAction => ({\r\n     type: chatUpdateThunk.UPDATE_CHAT_API_SUCESSS,\r\n     payload: chat\r\n});\r\n\r\nconst updateChatApiError = (error: Error): ChatAction => ({\r\n     type: chatUpdateThunk.UPDATE_CHAT_API_ERROR,\r\n     payload: error\r\n});\r\n\r\nexport const updateChatAction = (chatId: string, param: IChatUpdate) => (dispatch: any, getState: () => State) => {\r\n     dispatch(updateChatApiStarted());\r\n\r\n     switch (param.type) {\r\n          case chatUpdateEnum.NEW_MESSAGE:\r\n               const message: IMessage = param.value as IMessage;\r\n               insertNewMessage(chatId, message,\r\n                    chat => {\r\n                         sendNewNotificationMessageToServer(chatId);\r\n                         dispatch(updateChatApiSuccess(chat as IChat));\r\n                         // dispatch(setChatAction(chat as IChat));\r\n                         // we do to chat and chats\r\n                         dispatch(updateChatsAction(chatId , chat as IChat));\r\n                         // dispatch(findChatsApiAction());\r\n                    },\r\n                    error => dispatch(updateChatApiError(error))\r\n               );\r\n               break;\r\n          case chatUpdateEnum.DELETE_MESSAGE:\r\n               const messageId: string = param.value as string;\r\n               deleteMessageAPI(chatId, messageId,\r\n                    chat => {\r\n                         dispatch(updateChatApiSuccess(chat));\r\n                         dispatch(updateChatsAction(chatId , chat as IChat));\r\n                         emiteDeleteMessage(chat);\r\n                    },\r\n                    error => dispatch(updateChatApiError(error))\r\n               );\r\n               break;\r\n     }\r\n\r\n}\r\n\r\n","import React from 'react';\r\nimport { Dropdown } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { State } from '../../redux/types';\r\nimport { updateChatAction } from '../../redux/actions/chatActions/updateChatApiAction';\r\nimport { chatUpdateEnum } from '../../redux/enums/chatEnums'\r\nimport { IChat } from '../../redux/types/chat';\r\n\r\ninterface IProps {\r\n    children: string,\r\n    username: string,\r\n    date: string,\r\n    iAm: boolean,\r\n    messageId: string\r\n}\r\n\r\nconst Message = ({ children, date, username, iAm, messageId }: IProps) => {\r\n\r\n    const dispatch = useDispatch();\r\n    const chatResult: IChat = useSelector((state: State) => state.chat.result) as IChat;\r\n    const [floatValue, bgColorvalue] = iAm ? ['right', '#F5EEF8'] : ['left', '#EBDEF0'];\r\n\r\n    const deleteMessage = () => {\r\n        const { _id } = chatResult;\r\n        const chatId: string = _id as string;\r\n\r\n        dispatch(\r\n            updateChatAction(chatId, {\r\n                type: chatUpdateEnum.DELETE_MESSAGE,\r\n                value: messageId\r\n            })\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={` mx-3 my-2 rounded text-break p-2 float-${floatValue} border-shadow`}\r\n            style={{ width: '70%', backgroundColor: bgColorvalue, boxSizing: 'content-box', position: 'relative' }}\r\n        >\r\n            {iAm && (\r\n                <Dropdown style={{ position: 'absolute', bottom: 0, right: 0, transform: 'scale(0.8)', zIndex: 1 }}>\r\n                    <Dropdown.Toggle variant=\"secondary\"></Dropdown.Toggle>\r\n                    <Dropdown.Menu >\r\n                        <Dropdown.Item onClick={deleteMessage}>Borrar Mensaje</Dropdown.Item>\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n            )}\r\n            {/* ENCABEZADO */}\r\n            <div className='d-flex justify-content-between '>\r\n                <label className='text-nowrap  '>{username}</label>\r\n                <span className='text-nowrap '>{date}</span>\r\n            </div>\r\n            {/* TEXTO */}\r\n            <div>\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Message","import { State } from '../../types';\r\nimport { IChat } from '../../types/chat';\r\nimport { chatInsertThunk } from '../../enums/chatsEnums';\r\nimport { createNewChat } from '../../../services/chatServices';\r\nimport { ChatsAction } from '../../types/chats';\r\nimport { updateChatAction } from '../chatActions/updateChatAction';\r\nimport { emiteCreateChat } from '../../../socket/emitters';\r\n\r\nconst insertChatApiStarted = (): ChatsAction => ({\r\n     type: chatInsertThunk.INSERT_CHAT_API_STARTED,\r\n});\r\n\r\nconst insertChatApiSuccess = (chat: IChat): ChatsAction => ({\r\n     type: chatInsertThunk.INSERT_CHAT_API_SUCESSS,\r\n     payload: chat\r\n});\r\n\r\nconst insertChatApiError = (error: Error): ChatsAction => ({\r\n     type: chatInsertThunk.INSERT_CHAT_API_ERROR,\r\n     payload: error\r\n});\r\n\r\nexport const insertChatApiAction = (memberId1: string, memberId2: string, callback?: (newChat: IChat) => void) => (dispatch: any, getState: () => State) => {\r\n     dispatch(insertChatApiStarted());\r\n\r\n     createNewChat(memberId1, memberId2,\r\n          (chat) => {\r\n               dispatch(insertChatApiSuccess(chat));\r\n               dispatch(updateChatAction(chat));\r\n               callback && callback(chat);\r\n               emiteCreateChat(chat);\r\n          },\r\n          (error) => {\r\n               dispatch(insertChatApiError(error));\r\n          });\r\n\r\n}\r\n\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { updateChatAction } from '../../redux/actions/chatActions/updateChatApiAction';\r\nimport { findChatsApiAction } from '../../redux/actions/chatsActions/findChatApiAction';\r\nimport { chatUpdateEnum } from '../../redux/enums/chatEnums';\r\nimport { State } from '../../redux/types';\r\nimport { ChatState, IChat } from '../../redux/types/chat';\r\nimport { createNewChat } from '../../services/chatServices';\r\nimport { IMessage } from '../../types/Chat';\r\nimport { formatAMPM } from '../../utils';\r\nimport Message from './Message';\r\nimport fotoSend from '../../images/send.png';\r\nimport { UsersSearchState } from '../../redux/types/usersSearch';\r\nimport { UserState } from '../../redux/types/users';\r\nimport { ChatsState } from '../../redux/types/chats';\r\nimport { findChatAction } from '../../redux/actions/chatActions/findChatApiAction';\r\nimport { insertChatApiAction } from '../../redux/actions/chatsActions/insertChatApiAction';\r\n\r\nfunction Body() {\r\n     // OWN STATES\r\n     const [textInput, setTextInput] = useState('');\r\n     const [matchUserFindedBetweenUserChats, setMatchUserFindedBetweenUserChats] = useState(false);\r\n\r\n     const dispatch = useDispatch();\r\n\r\n     const userState: UserState = useSelector((state: State) => state.user);\r\n     const chatState: ChatState = useSelector((state: State) => state.chat);\r\n     const chatResult: IChat = chatState.result as IChat;\r\n     const searchUsersState: UsersSearchState = useSelector((state: State) => state.searchUsers);\r\n     const chatsState: ChatsState = useSelector((state: State) => state.chats);\r\n\r\n     useEffect(() => {\r\n          moveScrollToBottom();\r\n     }, [chatResult && chatResult.messages]);\r\n\r\n     // this useEffect is used every time that change the searchUserSelected to find if the search user selected match with an exists chat with me\r\n     useEffect(() => {\r\n          let _matchUserFindedBetweenUserChats = false;\r\n          let chatIdOfChatOfUserSelected = '';\r\n          const userFindendSelected = searchUsersState.result.UsersSearchData[searchUsersState.result.indexUserSearchedSelected];\r\n          // search if the user selected in the search contain chat with me;\r\n          chatsState.result.forEach(chat => {\r\n               if (userFindendSelected && chat.members[1].username === userFindendSelected.username) {\r\n                    _matchUserFindedBetweenUserChats = true;\r\n                    chatIdOfChatOfUserSelected = chat._id as string;\r\n                    return;\r\n               }\r\n          });\r\n          // if match then\r\n          if (_matchUserFindedBetweenUserChats) {\r\n               dispatch(findChatAction(chatIdOfChatOfUserSelected));\r\n               setMatchUserFindedBetweenUserChats(true);\r\n          } else setMatchUserFindedBetweenUserChats(false);\r\n     }, [searchUsersState.result.indexUserSearchedSelected]);\r\n\r\n     const divMessagesContainer = useRef<HTMLDivElement>(null);\r\n     const moveScrollToBottom = () => {\r\n          const f = divMessagesContainer.current\r\n          if (f) {\r\n               f.scrollTop = f.scrollHeight;\r\n          }\r\n     }\r\n     const handlerSendMessage = () => {\r\n          // if the usersearched clicked do not exists\r\n          if (searchUsersState.result.usersSearchModeActive && !matchUserFindedBetweenUserChats) {\r\n               const userId = userState.result._id;\r\n               const userIdSearchClick = searchUsersState.result.UsersSearchData[searchUsersState.result.indexUserSearchedSelected];\r\n\r\n               if (userIdSearchClick) {\r\n                    const member1 = userId as string;\r\n                    const member2 = userIdSearchClick._id as string;\r\n                    dispatch(insertChatApiAction(\r\n                         member1, member2,\r\n                         (newChat) => {\r\n                              const chatId = newChat._id as string\r\n\r\n                              const message: IMessage = {\r\n                                   author: userState.result,\r\n                                   date: new Date(),\r\n                                   text: textInput,\r\n                              }\r\n                              dispatch(updateChatAction(chatId, {\r\n                                   type: chatUpdateEnum.NEW_MESSAGE, value: message\r\n                              }));\r\n                              setMatchUserFindedBetweenUserChats(true);\r\n                              setTextInput('');\r\n                         }));\r\n\r\n               } else {\r\n                    console.log(\"can't send mensaje\");\r\n               }\r\n          } else {\r\n               const message: IMessage = {\r\n                    author: userState.result,\r\n                    date: new Date(),\r\n                    text: textInput,\r\n               }\r\n               const chatId = chatResult._id as string\r\n               // insertNewMessage();\r\n               dispatch(updateChatAction(chatId, {\r\n                    type: chatUpdateEnum.NEW_MESSAGE, value: message\r\n               }));\r\n               setTextInput('');\r\n          }\r\n     }\r\n     const hadlerInputText = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n          setTextInput(e.currentTarget.value)\r\n     }\r\n\r\n     const getMessagesBody = () => {\r\n          // validation if it isn't in users search mode and if matchUserFindedBetweenUserChats is true to find chat user else then not print the chat\r\n          if (searchUsersState.result.usersSearchModeActive && !matchUserFindedBetweenUserChats) {\r\n               const nombre = searchUsersState.result.UsersSearchData[searchUsersState.result.indexUserSearchedSelected];\r\n               return <div className='text-center pt-2'>Escribele a {nombre && nombre.username}</div>\r\n\r\n          }\r\n          return chatState.result && chatState.result.messages.map(message => {\r\n               const timeMessage = formatAMPM(new Date(message.date));\r\n               const isOwn = message.author._id === userState.result._id;\r\n               return (\r\n                    <div key={message._id}>\r\n                         <Message iAm={isOwn} username={message.author.username as string} date={timeMessage}\r\n                              messageId={message._id as string}\r\n                         >\r\n                              {message.text}\r\n                         </Message>\r\n                    </div>\r\n               )\r\n          });\r\n     }\r\n\r\n     return (\r\n          <div className='vh-100'>\r\n               <div ref={divMessagesContainer} className='border my-2' style={{ overflow: 'auto', height: 'calc(100% - 145px)', transition: 'all 0.5s' }}>\r\n                    {getMessagesBody()}\r\n               </div>\r\n               {/* BODY WRITE MESSAGE */}\r\n               <div className=' '>\r\n                    <div className='d-flex flex-nowrap pb-2'>\r\n                         <input\r\n                              onChange={hadlerInputText} placeholder='Escribe algo...' value={textInput}\r\n                              className='form-control ' style={{ backgroundColor: '#F8F9F9' }}\r\n                              onKeyPress={e => e.key === 'Enter' && handlerSendMessage()}\r\n                         />\r\n                         <img src={fotoSend} alt=\"boton enviar\" width='35px' className='ml-2' onClick={handlerSendMessage} />\r\n                    </div>\r\n               </div>\r\n          </div>\r\n     )\r\n}\r\n\r\nexport default Body;","\r\n\r\nexport function formatAMPM(date: any) {\r\n    var hours = date.getHours();\r\n    var minutes = date.getMinutes();\r\n    var ampm = hours >= 12 ? 'pm' : 'am';\r\n    hours = hours % 12;\r\n    hours = hours ? hours : 12; // the hour '0' should be '12'\r\n    minutes = minutes < 10 ? '0' + minutes : minutes;\r\n    var strTime = hours + ':' + minutes + ' ' + ampm;\r\n    return strTime;\r\n}","export default \"data:image/png;base64,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\"","import { State } from '../../types';\r\nimport { ChatAction, IChat } from '../../types/chat';\r\nimport { deleteChatApi } from '../../../services/chatServices';\r\nimport { Dispatch } from 'redux';\r\nimport { chatDeleteThunk } from '../../enums/chatEnums';\r\nimport { IChats } from '../../types/chats';\r\nimport { deleteChatsAction } from '../chatsActions/deleteChatAction';\r\nimport { emitDeleteChat } from '../../../socket/emitters';\r\nimport { VIEWS, context, paramView } from '../../../components/Background/BackgroundReducer'\r\nimport { useContext } from 'react';\r\n\r\nexport const deleteChatApiStarted = (): ChatAction => ({\r\n     type: chatDeleteThunk.DELETE_CHAT_API_ERROR,\r\n});\r\n\r\nexport const deleteChatApiSuccess = (chats: IChats): ChatAction => ({\r\n     type: chatDeleteThunk.DELETE_CHAT_API_SUCESSS,\r\n     payload: chats\r\n});\r\n\r\nexport const deleteChatApiError = (error: Error): ChatAction => ({\r\n     type: chatDeleteThunk.DELETE_CHAT_API_ERROR,\r\n     payload: error\r\n});\r\n\r\nlet setView = (arg0: paramView) => {}\r\n\r\nconst F = () => {\r\n     const c = useContext(context);\r\n     setView = c.setView;\r\n}\r\n\r\n\r\nexport const deleteChatApiAction = () => async (dispatch: Dispatch<any>, getState: () => State) => {\r\n     const chatId: string = getState().chat.result?._id as string;\r\n     const chat: IChat = getState().chat.result as IChat;\r\n\r\n     dispatch(deleteChatApiStarted());\r\n     deleteChatApi(chatId,\r\n          (chats: IChats) => {\r\n               setView(VIEWS.VIEW_LISTA_CHAT.value);\r\n               dispatch(deleteChatApiSuccess(chats));\r\n               dispatch(deleteChatsAction(chatId));\r\n               emitDeleteChat(chat);\r\n          },\r\n          (error: Error) => {\r\n               dispatch(deleteChatApiError(error));\r\n          });\r\n\r\n}","import React, { useState } from 'react';\r\nimport deleteChatImage from '../../images/delete-chat.png';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Head from './Head';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { State } from '../../redux/types/index';\r\nimport Body from './Body';\r\nimport { UsersSearchState } from '../../redux/types/usersSearch';\r\nimport { deleteChatApiAction } from '../../redux/actions/chatActions/deleteChatApiAction';\r\nimport { ChatState, IChat } from '../../redux/types/chat';\r\n\r\nfunction ViewChat() {\r\n\r\n    const dispatch = useDispatch();\r\n    const chatState: ChatState = useSelector((state: State) => state.chat);\r\n    const chatResult: IChat = chatState.result as IChat;\r\n    const searchUsersState: UsersSearchState = useSelector((state: State) => state.searchUsers);\r\n    const [showModel, setShowModal] = useState(false);\r\n    const canRenderChat = searchUsersState.result.indexUserSearchedSelected !== -1 || chatResult ? true : false;\r\n\r\n    const deleteChat = () => {\r\n        dispatch(deleteChatApiAction());\r\n    }\r\n\r\n    return (\r\n        <div className='vh-100 view-chat-container' style={{ backgroundColor: 'white', position: 'relative' }}>\r\n            {canRenderChat ? (\r\n                <>\r\n                    {/* MODALS*/}\r\n                    <Modal show={showModel} centered={true}>\r\n                        <Modal.Header className=''>\r\n                            <strong className='fw-bold'>Enserio quieres eliminar este chat?</strong>\r\n                            <img src={deleteChatImage} alt='image of delete chat' />\r\n                        </Modal.Header>\r\n                        <Modal.Footer>\r\n                            <Button variant='danger' onClick={() => setShowModal(false)}>Cancelar</Button>\r\n                            <Button variant='info' onClick={() => { setShowModal(false); deleteChat(); }}>Confirmar</Button>\r\n                        </Modal.Footer>\r\n                    </Modal>\r\n                    {/* HEAD */}\r\n                    <Head setShowModal={setShowModal} />\r\n                    {/* BODY MESSAGE */}\r\n                    <Body />\r\n                </>\r\n            ) : (\r\n                <div className='border h-100 d-flex justify-content-center align-items-center '> <span >Escribele a alguien </span></div>\r\n            )}\r\n        </div >\r\n    )\r\n\r\n\r\n}\r\nexport default ViewChat;","export default \"data:image/png;base64,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\"","export const setTokenLocalStorage = async (token?: string) => {\r\n     if (token) {\r\n          localStorage.setItem('token', token);\r\n     } else {\r\n          const tokenLS = localStorage.getItem('token') ;\r\n          return tokenLS;\r\n     }\r\n}","import axios from '../customAxios'\r\n\r\nexport const registerNewUserAndGetToken = async (username: string, password: string, imgBase64: string) => {\r\n     const body = {\r\n          username,\r\n          password,\r\n          userLogImage: imgBase64\r\n     }\r\n     try {\r\n          console.log(body);\r\n          const res = await axios.post('/sign', body);\r\n          return res.data;\r\n     } catch (error) {\r\n\r\n          console.log(`Registering new user. Error ${error.response?.data}`);\r\n          return null;\r\n     }\r\n}\r\n\r\n\r\nexport const verifyUserCorrect = async (username: string, password: string) => {\r\n     const body = {\r\n          user: {\r\n               username,\r\n               password\r\n          }\r\n     }\r\n     try {\r\n          const res = await axios.post('/log', body);\r\n          return res.data;\r\n     } catch (error) {\r\n          console.log(`Verifing user correct. Error ${error.response?.data}`);\r\n          return { token: null };\r\n     }\r\n}\r\n\r\nexport const verifyValidToken = async (token: string) => {\r\n     const body = { token }\r\n     try {\r\n          const res = await axios.post('log', body);\r\n          return res.data.tokenValid;\r\n\r\n     } catch (error) {\r\n          console.log(`Verifing valid token. Error ${error.response?.data}`);\r\n          return null;\r\n     }\r\n}","import { State } from '../../types';\r\nimport { ChatsAction, IChats, ChatsDispatch } from '../../types/chats';\r\nimport { getChatsApi } from '../../../services/chatServices';\r\nimport { findChatsEnumThunk } from '../../enums/chatsEnums';\r\n\r\nconst findChatsApiStarted = (): ChatsAction => ({\r\n     type: findChatsEnumThunk.FIND_CHATS_API_STARTED,\r\n});\r\n\r\nconst findChatsApiSuccess = (res: IChats): ChatsAction => ({\r\n     type: findChatsEnumThunk.FIND_CHATS_API_SUCESSS,\r\n     payload: res\r\n});\r\n\r\nconst findChatsApiError = (error: Error): ChatsAction => ({\r\n     type: findChatsEnumThunk.FIND_CHATS_API_ERROR,\r\n     payload: error\r\n});\r\n\r\nexport const findChatsApiAction = () => (dispatch: ChatsDispatch, getState: () => State) => {\r\n     dispatch(findChatsApiStarted());\r\n     const userId = getState().user.result._id as string;\r\n\r\n     // getting all chats in the found user\r\n     getChatsApi(\r\n          userId,\r\n          chats => dispatch(findChatsApiSuccess(chats)),\r\n          error => dispatch(findChatsApiError(error))\r\n     )\r\n};\r\n\r\n\r\n","import { getUserByIdApi } from '../../../services/userServices';\r\nimport { State, } from '../../types';\r\nimport { IUser, UserAction, UserDispatch } from '../../types/users'\r\nimport { findUserEnumThunk } from '../../enums/userEnum'\r\n\r\nconst findUserStarted = (): UserAction => ({\r\n     type: findUserEnumThunk.FIND_USER_API_STARTED\r\n})\r\n\r\nconst findUserSuccess = (result: IUser): UserAction => ({\r\n     type: findUserEnumThunk.FIND_USER_API_SUCCESS,\r\n     payload: result\r\n})\r\n\r\nconst findUserError = (error: Error): UserAction => ({\r\n     type: findUserEnumThunk.FIND_USER_API_ERROR,\r\n     payload: error\r\n})\r\n\r\nexport const findUserApiAction = (userId: string) => (dispath: UserDispatch, getState: () => State) => {\r\n\r\n     // INIT DE ACTION \r\n     dispath(findUserStarted());\r\n\r\n     getUserByIdApi(\r\n          userId,\r\n          usuario => dispath(findUserSuccess(usuario)),\r\n          error => dispath(findUserError(error))\r\n     )\r\n}\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport Webcam from 'react-webcam';\r\nimport axiosClient from '../../../customAxios';\r\nimport backImage from '../../../images/back.png';\r\n\r\ninterface Props {\r\n     switchFacialReconitionAndLoginWithCredentialsViews: () => void,\r\n     runLoadApp: (token: string) => void\r\n}\r\n\r\nfunction FacialLogin({ switchFacialReconitionAndLoginWithCredentialsViews, runLoadApp }: Props) {\r\n     const webcamRef = React.useRef(null);\r\n     const [Loading, setLoading] = useState(false);\r\n\r\n     async function capture() {\r\n          const imageSrc = (webcamRef.current as any).getScreenshot();\r\n          const obj = {\r\n               resource: {\r\n                    userId: '604ee937a0b0111d94cb4ece',\r\n                    base64image: imageSrc\r\n               }\r\n          }\r\n          setLoading(true);\r\n          axiosClient.post('/log', obj)\r\n               .then(res => {\r\n                    setLoading(false);\r\n                    const { username, token } = res.data;\r\n                    if (token) {\r\n                         console.log(res.data);\r\n                         runLoadApp(token);\r\n                         alert('Has sido indentificado como ' + username);\r\n                    } else {\r\n                         alert('Tu cara no coincide')\r\n                    }\r\n               }).catch(error => console.log(error));\r\n     }\r\n     return (\r\n          <div className='d-flex justify-content-center align-items-center w-100 vh-100' style={{ backgroundColor: '#F6F6F6', position: 'relative' }}>\r\n               {/* LOADER */}\r\n               {Loading && (\r\n                    <div\r\n                         className=\"d-flex justify-content-center align-items-center  text-success \"\r\n                         style={{ transform: 'scale(2)', margin: 'auto', position: 'absolute', left: 'calc(50% - 30px)', zIndex: 1 }}\r\n                    >\r\n                         <div className=\"spinner-border ms-auto \" role=\"status\" aria-hidden=\"true\"></div>\r\n                         <strong className='ml-3' style={{}}>Loading...</strong>\r\n                    </div>\r\n               )}\r\n               <div className=\"card border p-4\" style={{ width: 600, filter: Loading ? `blur(5px)` : '' }}>\r\n                    <img\r\n                         style={{ position: 'absolute', left: 0 }}\r\n                         className='ml-4 hover' src={backImage}\r\n                         alt=\"back-image\"\r\n                         onClick={switchFacialReconitionAndLoginWithCredentialsViews}\r\n                    />\r\n                    <h2 className='mb-4 text-center'>Inicio de Sesion</h2>\r\n                    {/* {Loading && <h1>Loading...</h1>} */}\r\n                    \r\n                         <Webcam\r\n                              audio={false}\r\n                              ref={webcamRef}\r\n                              screenshotFormat=\"image/jpeg\"\r\n                              className='w-100 mb-3'\r\n                         />\r\n                    \r\n                    <p>Debe mirar a la camara y no hacer expresiones extranas, porfavor tener los menos elementos posibles y tambien que solo se vea su cara de preferencia</p>\r\n                    <button onClick={capture} className='btn btn-primary'>Iniciar Sesion</button>\r\n               </div>\r\n          </div>\r\n     );\r\n};\r\n\r\nexport default FacialLogin;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAdCAYAAADGgB7AAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAPLSURBVFhHjZbbVRxBDEQ3GrNPnATfBpIEUiIBAiCBta56bk/teDnHH2WppZJUo55ZvNsfj1dwPJ+HPZ0apzof6rzF/nCYvlz9zhGr2vPlMvOAfljjnsHl8bHPWPL4OxoBRLWt5sBihmKNZf4uintamm9FcHbwTc0mh53C3FhuAtw7P+z3U7BD5Nkv88ljqDnP+jcbe2ADRfQ6KXIIm8kmmUsO+blR+NWcAfLwBTFADUJSjNwW1mKKiMDe3AK3ko04Y3MAMR+gY5UHOcw6kT3hAd8zz32VPCXCuulSZKF2Do6z9uadI7ZwGJA8LBzi5oVn+7cwRfV10rygEGzCQsUYAzSmBz0dIh/I2cYzrz+F0XArTPhECWPk/zw/Xz8/P69PT0/jdQiOw+xlfYqAx1WSf/z9u89TGBa4iWwmiOe1EXt+ebl+fX1d397fB4/4Ug8caE/PDMfKy4doYV6hDR0OwYZp9eEo6r1EzXxZvkrO9MAK8goxho9YfARxnhv7VV+g4iTbxCcBxBCEfXl9naIcRK5fhzoTM27PHGzsJ/TvmNtSjEWc8RWkzzuFqI+PjxkH7VMfPbApKPtPnM79bskB8yr7y1yaKwjo25A8L/r39/d/w9rso8gWcx6+4rja9atcgBCS+vlDK8drfHt765zoGgQsA60TnskpYPglrLaGr+CdRCyNbWLsHuD98zUKOEut12Jf8vTFmhtzSlQBDmKJ7/gnB0IUOVAOMHfvq2SIG7Mn9lbI7YMfjpWvrTUWXm9sJdwKoCkkBZPHchZ5rWPYEGYP6/AVBtZrxK8f1RAGd+cwbf6XBmtTgBB9OSkOe77UD2jlyYHk4mMdrlBqFMaVEp/CbIC1AfaeGH3zWcfGuBp8BaQYfLFyKr8Iu5RIci0MsCmI+IpxIER9cpkH5scwsT6gfK4vew7+eJjeVAk7Lu/b3BjFXmMOUwg+T2dMHo31x3lsbB1668PxTD96Yb3GG2FJXgfcDjQGaKafuWHpMx4qa4APixD8cY0jznvm1loYCQZthQFixs3ZCLv98R01450h5penEOGV5oyO8+Ec6r8+9ZX2xhzqJiBZZC55xhGmjx3guleedeb1FZv9EMXWsL2xbZO0P/k2N85D+WD5jsnBJ5ZzthvF8o6BHc22Lz1FNsrhNgXk0zc36t3eKkI+/cTKH/nug0VYH5akRKzvjOCcg5KDzfzDfmzO4fjWuKX0BTHssez8k9SBaGDM3zfzmcMiCJs5fTnZWxCTk+hc4ce/lUkkDtyQMfJbYcbZFtaYHPsCa8xRM2LH618i/rSj5Ifp+AAAAABJRU5ErkJggg==\"","import React, { useContext, useEffect, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { verifyUserCorrect } from '../../../services/authServices';\r\nimport { getUserByToken, userExistsFetch } from '../../../services/userServices';\r\nimport { setTokenLocalStorage } from '../../../utils/localStorage';\r\nimport { useDebounce } from 'use-debounce'\r\nimport { context, VIEWS } from '../../Background/BackgroundReducer';\r\nimport { IUser } from '../../../redux/types/users';\r\nimport { State } from '../../../redux/types';\r\nimport { findChatsApiAction } from '../../../redux/actions/chatsActions/findChatApiAction';\r\nimport { findUserApiAction } from '../../../redux/actions/userActions/findUserApiAction';\r\nimport CameraTest from './FacialLogin';\r\nimport '../style.css';\r\nconst initialState = { messageError: '', bootstrapStyleInput: '' }\r\n\r\nconst Login = () => {\r\n     const dispatch = useDispatch();\r\n     const userState = useSelector((state: State) => state.user);\r\n     const chatsState = useSelector((state: State) => state.chats);\r\n     const [passToFacialRecognitionView, setPassToFacialRecognitionView] = useState(false);\r\n     const [userValidationLog, setUserValidationLog] = useState(initialState);\r\n\r\n     const [passInput, setPassInput] = useState('');\r\n     const [userInput, setUserInput] = useState('');\r\n     // const [passValidationLogin, setPassValidationSign] = useState(initialState);\r\n     const [userDebounce] = useDebounce(userInput, 700);\r\n\r\n     const { setView } = useContext(context);\r\n\r\n     useEffect(() => {\r\n          (async () => {\r\n               // validacion para que no entre en validateUserSign() cuando cargue por primera vez el componente\r\n               if (userInput !== '') {\r\n                    const userExists: boolean = await userExistsFetch(userInput) as boolean;\r\n                    if (userExists) setUserValidationLog({ bootstrapStyleInput: '', messageError: '' });\r\n                    else setUserValidationLog({ bootstrapStyleInput: 'is-invalid', messageError: 'Este usuario no existe' });\r\n               }\r\n          })();\r\n\r\n     }, [userDebounce]);\r\n\r\n     useEffect(() => {\r\n          // validation to do not entry first time\r\n          if (!userState.loading && passInput !== '') {\r\n               // console.log('yo no te puedo hablar');\r\n               dispatch(findChatsApiAction());\r\n          }\r\n     }, [userState.loading]);\r\n\r\n     useEffect(() => {\r\n          // validation to do not entry first time\r\n          if (!chatsState.loading && passInput !== '') {\r\n               setPassInput('');\r\n               setUserInput('');\r\n               setView(VIEWS.VIEW_LISTA_CHAT.value);\r\n          }\r\n     }, [chatsState.loading]);\r\n\r\n\r\n     const submit = async () => {\r\n          // validacion de que tiene que existir el usuario \r\n          if (userValidationLog.messageError === '' && userInput !== '' && passInput !== '') {\r\n               const { token } = await verifyUserCorrect(userInput, passInput);\r\n               if (token) {\r\n                    // getting token of local storage\r\n                    setTokenLocalStorage(token);\r\n                    // cargamos data a redux y aplicacion\r\n                    const user: IUser = await getUserByToken(token);\r\n                    // console.log(user);\r\n                    if (user) {\r\n                         dispatch(findUserApiAction(user._id as string));\r\n                    }\r\n               } else {\r\n                    alert('Contrasena incorrecta');\r\n               }\r\n          }\r\n     }\r\n\r\n     async function runLoadApp(token: string) {\r\n          // getting token of local storage\r\n          setTokenLocalStorage(token);\r\n          // cargamos data a redux y aplicacion\r\n          const user: IUser = await getUserByToken(token);\r\n          // console.log(user);\r\n          if (user) {\r\n               dispatch(findUserApiAction(user._id as string));\r\n          }\r\n     }\r\n\r\n     const setToSignIn = () => {\r\n          setView(VIEWS.VIEW_SIGNIN.value);\r\n     }\r\n     const switchFacialReconitionAndLoginWithCredentialsViews = () => setPassToFacialRecognitionView(!passToFacialRecognitionView)\r\n\r\n\r\n\r\n     return (\r\n          <>{passToFacialRecognitionView ? (\r\n               <CameraTest\r\n                    switchFacialReconitionAndLoginWithCredentialsViews={switchFacialReconitionAndLoginWithCredentialsViews}\r\n                    runLoadApp={runLoadApp}\r\n               />\r\n          ) : (\r\n               <div className='d-flex justify-content-center align-items-center w-100 vh-100' style={{ backgroundColor: '#F6F6F6' }} >\r\n                    <div className=\"card border p-5\" style={{ width: 500 }}>\r\n                         <h2 className='mb-4'>Inicio de Sesion</h2>\r\n                         <div className='p-1'>\r\n                              <label className='mr-3'>Usuario</label>\r\n                              <input\r\n                                   className={`form-control ${userValidationLog.bootstrapStyleInput} ${userValidationLog.bootstrapStyleInput}`}\r\n                                   type=\"text\"\r\n                                   value={userInput} onChange={(e) => setUserInput(e.currentTarget.value)}\r\n                              />\r\n                              <span style={{ color: '#F94D4D' }}>{userValidationLog.messageError}{userValidationLog.messageError}</span>\r\n                         </div>\r\n                         {/* PASSWORD */}\r\n                         <div className='p-1'>\r\n                              <label className='mr-3'>Contrasena</label>\r\n                              <input\r\n                                   className={`form-control`}\r\n                                   type=\"password\" value={passInput}\r\n                                   onChange={(e) => setPassInput(e.currentTarget.value)}\r\n                              />\r\n                         </div>\r\n                         {/* BUTTON */}\r\n                         <div className='mt-5 d-flex justify-content-between mt-2'>\r\n                              <a\r\n                                   className='link-info hover'\r\n                                   onClick={switchFacialReconitionAndLoginWithCredentialsViews}\r\n                              >Reconocimiento Facial</a>\r\n                              <button onClick={submit} className=\"btn btn-primary\">Iniciar Sesion</button>\r\n                         </div>\r\n                         {/* INICIAR SESION  */}\r\n                         <div className='d-flex justify-content-center' >\r\n                              <span\r\n                                   className='link-info hover' onClick={setToSignIn}\r\n                                   style={{ position: 'absolute', bottom: 10 }}>\r\n                                   Crear Cuenta\r\n                         </span>\r\n                         </div>\r\n                    </div>\r\n               </div >\r\n          )}</>\r\n     )\r\n}\r\n\r\n\r\n\r\nexport default Login;","import { userExistsFetch } from \"../../services/userServices\";\r\n\r\nexport const validateUserSign = async (username: string) => {\r\n     let res = { messageError: '', bootstrapStyleInput: 'is-valid' };\r\n\r\n     if (!validateSpaceBlack(username)) {\r\n          res.messageError = 'El usuario no puede tener espacios en blanco';\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n     } else if (username.trim().length <= 5) {\r\n          res.messageError = 'La usuario debe tener mas de 5 caracteres';\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n     } else if (!has2numbers(username.trim())) {\r\n          res.messageError = 'La usuario debe tener por lo menos 2 numeros';\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n     }\r\n     const userExists: boolean = await userExistsFetch(username) as boolean;\r\n     if (userExists) {\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n          res.messageError = 'Este nombre de  usuario ya existe';\r\n     }\r\n     return res;\r\n}\r\n\r\nexport const validatePassSign = (cadena: string) => {\r\n     const res = { messageError: '', bootstrapStyleInput: 'is-valid' }\r\n     if (!validateSpaceBlack(cadena)) {\r\n          res.messageError = 'La contrasena no puede tener espacios en blanco';\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n     }\r\n     else if (cadena.length <= 5) {\r\n          res.messageError = 'La contrasena debe tener mas de 5 caracteres';\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n     } else if (!has2numbers(cadena)) {\r\n          res.messageError = 'La contrasena debe tener por lo menos 2 numeros';\r\n          res.bootstrapStyleInput = 'is-invalid';\r\n     }\r\n     return res;\r\n}\r\n\r\nconst has2numbers = (cadena: string) => {\r\n     let countNumbers = 0;\r\n     for (const letter of cadena) if (isNumber(Number(letter))) countNumbers++;\r\n     return countNumbers >= 2 ? true : false;\r\n}\r\n\r\nconst validateSpaceBlack = (cadena: string) => {\r\n     for (const letter of cadena) {\r\n          if (letter === ' ') return false;\r\n     }\r\n     return true\r\n}\r\n\r\n\r\nfunction isNumber(n: any) { return Number(n) === n }","import React, { LegacyRef, useContext, useEffect, useRef, useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useDebounce } from 'use-debounce/lib';\r\nimport { registerNewUserAndGetToken } from '../../../services/authServices';\r\nimport { getUserByToken } from '../../../services/userServices';\r\nimport { findChatsApiAction } from '../../../redux/actions/chatsActions/findChatApiAction';\r\nimport { findUserApiAction } from '../../../redux/actions/userActions/findUserApiAction';\r\nimport { setTokenLocalStorage } from '../../../utils/localStorage';\r\nimport { context, VIEWS } from '../../Background/BackgroundReducer';\r\nimport { validateUserSign, validatePassSign } from '../Validation';\r\nimport Webcam from 'react-webcam';\r\nimport '../style.css'\r\nconst initialState = { messageError: '', bootstrapStyleInput: '' }\r\n\r\nconst SignIn = () => {\r\n\r\n     const dispatch = useDispatch();\r\n     const webcamRef: LegacyRef<Webcam> = useRef(null);\r\n     const { setView } = useContext(context);\r\n     const [passInput, setPassInput] = useState('');\r\n     const [userInput, setUserInput] = useState('');\r\n     const [userDebounce] = useDebounce(userInput, 700);\r\n     const [userValidationSign, setUserValidationSign] = useState(initialState);\r\n     const [passValidationSign, setPassValidationSign] = useState(initialState);\r\n\r\n     // effect to validate user\r\n     useEffect(() => {\r\n          (async () => {\r\n               // validacion para que no entre en validateUserSign() cuando cargue por primera vez el componente\r\n               if (userInput !== '') {\r\n                    const val = await validateUserSign(userInput);\r\n                    setUserValidationSign(val);\r\n               }\r\n          })();\r\n     }, [userDebounce]);\r\n\r\n     // effecto to validate pass \r\n     useEffect(() => {\r\n          const validate = validatePassSign(passInput);\r\n          setPassValidationSign(validate);\r\n     }, [passInput])\r\n\r\n\r\n     const userInputHandler = (value: string) => setUserInput(value);\r\n\r\n     const setToLogin = () => setView(VIEWS.VIEW_LOGIN.value);\r\n\r\n     const submit = async () => {\r\n          if (userValidationSign.messageError === '' && userValidationSign.messageError === '' && userInput !== '' && passInput !== '') {\r\n               if (!webcamRef.current) throw new Error();\r\n               const imageSrc = webcamRef.current.getScreenshot() as string;\r\n               const token = await registerNewUserAndGetToken(userInput, passInput, imageSrc);\r\n               setTokenLocalStorage(token);\r\n               // cargamos data a redux y la aplicacion\r\n               const user = await getUserByToken(token);\r\n               dispatch(findUserApiAction(user._id));\r\n               dispatch(findChatsApiAction());\r\n               setView(VIEWS.VIEW_LISTA_CHAT.value);\r\n          }\r\n     }\r\n\r\n     return (\r\n          <div className='d-flex justify-content-center align-items-center w-100 vh-100' style={{ backgroundColor: '#F6F6F6' }}>\r\n               <div className=\"card p-4\" style={{ width: 420 }}>\r\n                    <h2 className='mb-4'>Crear Cuenta</h2>\r\n                    <Webcam\r\n                         ref={webcamRef}\r\n                         audio={false}\r\n                         screenshotFormat=\"image/jpeg\"\r\n                         className='w-100'\r\n\r\n                    />\r\n                    <span className='text-center'>Mira a la camara, trata de que solo se vea tu cara y de que halla luz cuando des a iniciar sesion</span>\r\n                    {/* username */}\r\n                    <div className='p-1'>\r\n                         <label className='mr-3'>Usuario</label>\r\n                         <input\r\n                              className={`form-control ${userValidationSign.bootstrapStyleInput} ${userValidationSign.bootstrapStyleInput}`}\r\n                              type=\"text\"\r\n                              value={userInput} onChange={(e) => userInputHandler(e.currentTarget.value)}\r\n                         />\r\n                         <span style={{ color: '#F94D4D' }}>{userValidationSign.messageError}</span>\r\n                    </div>\r\n                    {/* PASSWORD */}\r\n                    <div className='p-1'>\r\n                         <label className='mr-3'>Contrasena</label>\r\n                         <input\r\n                              className={`form-control ${passValidationSign.bootstrapStyleInput}`}\r\n                              type=\"password\" value={passInput}\r\n                              onChange={(e) => setPassInput(e.currentTarget.value)}\r\n                         />\r\n                         <span style={{ color: '#F94D4D' }}>{passValidationSign.messageError}</span>\r\n                    </div>\r\n                    {/* BUTTON */}\r\n                    <div className='mt-3 d-flex justify-content-center'>\r\n                         <button onClick={submit} className=\"btn btn-primary\">Crear la cuenta</button>\r\n                    </div>\r\n                    {/* INICIAR SESION - REGISTRARSE */}\r\n                    <div className='mb-3 d-flex justify-content-center' >\r\n                         <span\r\n                              className='nav-link active hover' onClick={setToLogin}\r\n                              style={{ position: 'absolute', bottom: 0 }}>\r\n                              Iniciar Sesion\r\n                         </span>\r\n                    </div>\r\n               </div>\r\n          </div>\r\n     )\r\n}\r\n\r\nexport default SignIn;","import React, { useEffect, useReducer, useState } from 'react'\r\nimport ViewListaChat from '../ViewListaChat/ViewListaChat'\r\nimport ViewChat from '../ViewChat/ViewChat'\r\nimport { setTokenLocalStorage } from '../../utils/localStorage';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { getUserByToken } from '../../services/userServices';\r\nimport { context, reducer, VIEWS } from './BackgroundReducer';\r\nimport { verifyValidToken } from '../../services/authServices';\r\nimport Login from '../ViewAuth/login/Login';\r\nimport Signin from '../ViewAuth/signin/Signin';\r\nimport { State } from '../../redux/types';\r\nimport { findUserApiAction } from '../../redux/actions/userActions/findUserApiAction';\r\nimport { findChatsApiAction } from '../../redux/actions/chatsActions/findChatApiAction';\r\nimport { findChatAction } from '../../redux/actions/chatActions/findChatApiAction';\r\nimport { socketId } from '../../socket/listeners/index'\r\nimport { emiteNewConnection } from '../../socket/emitters';\r\n\r\nconst Background = () => {\r\n    const dispatch = useDispatch();\r\n    const chatsState = useSelector((state: State) => state.chats);\r\n    const chatState = useSelector((state: State) => state.chat);\r\n    const userState = useSelector((state: State) => state.user);\r\n\r\n    const [view, _setView] = useReducer(reducer, VIEWS);\r\n    const [x, reload] = useReducer(x => x + 1, 0);\r\n    const [activeChatId, setActiveChatId] = useState('');\r\n    const [primerFindChat, setPrimerFindChat] = useState(true)\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            // LOAD INITIAL DATA\r\n            // getting token of local storage\r\n            const token = await setTokenLocalStorage() as string;\r\n            // verify if token is valid\r\n            if (token) {\r\n                const tokenValid = await verifyValidToken(token);\r\n                // if token exists then load the aplication else then load login view\r\n                if (tokenValid) {\r\n                    setView(VIEWS.VIEW_LISTA_CHAT.value);\r\n                    const user = await getUserByToken(token);\r\n                    // console.log(user);\r\n                    if (user) {\r\n                        dispatch(findUserApiAction(user._id));\r\n                    }\r\n                }\r\n            }\r\n        })();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // este efecto es para que cargue los chats despues que cargue el usuario, que el la busqueda de chats depende\r\n        // del usuario\r\n        if (!userState.loading && userState.result.username !== \"\") {\r\n            let userId: string = userState.result._id as string;\r\n            emiteNewConnection(userId);\r\n            dispatch(findChatsApiAction())\r\n        };\r\n    }, [userState.loading]);\r\n\r\n    useEffect(() => {\r\n        // estos es para que cargue por default el primer chat \r\n        if (!chatsState.loading && chatsState.result.length > 0 && primerFindChat) {\r\n            setPrimerFindChat(false);\r\n            const firstChat = chatsState.result[0]._id as string;\r\n            dispatch(findChatAction(firstChat));\r\n        }\r\n    }, [chatsState.loading]);\r\n\r\n    function setView(view: string) {\r\n        _setView(view);\r\n        reload();\r\n    }\r\n\r\n\r\n    return (\r\n        <context.Provider value={{ setView, activeChatId, setActiveChatId }}>\r\n            {/* {(()=> console.log(view))()} */}\r\n            <div className='container-fluid' style={{ backgroundColor: ' #FCFCFC' }}>\r\n                <div className=\"row vh-100\">\r\n                    {(view.VIEW_LOGIN.display !== '' && view.VIEW_SIGNIN.display !== '') && <>\r\n                        <div className={`col-12 col-md-5 ${view.VIEW_LISTA_CHAT.display}`}>\r\n                            <ViewListaChat />\r\n                        </div>\r\n                        <div className={`col-12 col-md-7 ${view.VIEW_CHAT.display}`} >\r\n                            <ViewChat />\r\n                        </div>\r\n                    </>}\r\n                    <>\r\n                        <div className={`col-12 ${view.VIEW_LOGIN.display} `}>\r\n                            <Login />\r\n                        </div>\r\n                        <div className={`col-12 ${view.VIEW_SIGNIN.display}`}>\r\n                            <Signin />\r\n                        </div>\r\n                    </>\r\n                </div>\r\n            </div>\r\n        </context.Provider>\r\n    )\r\n}\r\n\r\nexport default Background;","import React from 'react';\r\nimport Background from './components/Background/Background';\r\nimport { Provider } from 'react-redux';\r\nimport store from './redux';\r\nimport { emiteCloseConnection } from './socket/emitters';\r\n\r\n\r\nwindow.addEventListener('beforeunload', function (e) {\r\n  setTimeout(() => {\r\n\r\n    emiteCloseConnection();\r\n    e.preventDefault();\r\n    e.returnValue = 'Enserio?';\r\n  }, 2000);\r\n});\r\n\r\n\r\n\r\nfunction App() {\r\n  return (\r\n    <Provider store={store}>\r\n\r\n      <Background />\r\n    </Provider>\r\n  );\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n\r\n  <App />\r\n  ,\r\n  document.getElementById('root')\r\n);\r\n\r\n"],"sourceRoot":""}